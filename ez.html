<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <title>ğŸ§¬ å½¥å½¬ è‡ªæª¢è¡¨ç³»çµ±</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>

  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: { 
            primary: '#00B900', 
            secondary: '#E8F4EA',
            lightBg: '#f8faf9'
          },
          fontFamily: { sans: ['Noto Sans TC', 'sans-serif'] }
        }
      }
    };
  </script>

  <style type="text/tailwindcss">
    @layer utilities {
      .fade-in { animation: fadeIn 0.45s ease-in-out; }
      .slide-down { animation: slideDown 0.5s ease-out; }
      .table-hover-row:hover { background-color: theme('colors.secondary'); }
      .scale-in { animation: scaleIn 0.3s ease-out; }
    }
    @keyframes fadeIn { from { opacity: 0 } to { opacity: 1 } }
    @keyframes slideDown { from { transform: translateY(-20px); opacity: 0 } to { transform: translateY(0); opacity: 1 } }
    @keyframes scaleIn { from { transform: scale(0.98); opacity: 0 } to { transform: scale(1); opacity: 1 } }
  </style>
</head>
<body class="bg-lightBg min-h-screen flex items-center justify-center p-4">
  <div class="max-w-4xl w-full bg-white rounded-xl shadow-md overflow-hidden fade-in">
    <div class="bg-primary p-6 text-white text-center">
      <i class="fa fa-heartbeat text-4xl mb-3"></i>
      <h1 class="text-2xl font-bold">ğŸ§¬ å½¥å½¬ è‡ªæª¢è¡¨ç³»çµ±</h1>
    </div>

    <div class="p-6">
      <div id="status" class="flex items-center justify-center py-6 text-gray-700 text-center">
        <div class="text-center">
          <div class="inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary mb-3"></div>
          <p id="status-text">æ­£åœ¨åˆå§‹åŒ– LIFF...</p>
        </div>
      </div>

      <div id="error-message" class="hidden bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4"></div>

      <div id="result-card" class="hidden bg-secondary/50 border border-primary/20 rounded-lg p-5 mb-6 text-center slide-down">
        <div id="result-main" class="text-lg font-medium mb-2"></div>
        <div id="result-details" class="text-sm text-gray-700 mb-3"></div>
      </div>

      <!-- è‡ªæª¢è¡¨å€åŸŸ - é è¨­éš±è—ï¼Œé©—è­‰é€šéå¾Œè‡ªå‹•é¡¯ç¤º -->
      <div id="checklist-section" class="hidden scale-in">
        <!-- è‡ªæª¢è¡¨æ¨™é¡Œå€åŸŸ -->
        <div class="mb-6 text-center">
          <h2 class="text-2xl font-bold text-primary mb-2">è‡ªæª¢è¡¨å¡«å¯«å€åŸŸ</h2>
          <p class="text-gray-600">è«‹æ ¹æ“šè‡ªèº«æƒ…æ³åƒè€ƒä»¥ä¸‹è¡¨æ ¼é€²è¡Œå¥åº·è‡ªæª¢</p>
        </div>

        <!-- èº«é«”èªè¨€ç°¡è¡¨ -->
        <div class="mb-8">
          <h3 class="text-xl font-bold text-gray-800 mb-3 flex items-center">
            <i class="fa fa-list-alt text-primary mr-2"></i>èº«é«”èªè¨€ç°¡è¡¨
          </h3>
          <div class="overflow-x-auto rounded-lg border border-gray-200 shadow-sm">
            <table class="w-full border-collapse">
              <thead class="bg-primary text-white">
                <tr>
                  <th class="p-2 border border-gray-300 text-center">åºè™Ÿ</th>
                  <th class="p-2 border border-gray-300 text-center">ç—‡ç‹€</th>
                  <th class="p-2 border border-gray-300 text-center">åºè™Ÿ</th>
                  <th class="p-2 border border-gray-300 text-center">ç—‡ç‹€</th>
                  <th class="p-2 border border-gray-300 text-center">åºè™Ÿ</th>
                  <th class="p-2 border border-gray-300 text-center">ç—‡ç‹€</th>
                  <th class="p-2 border border-gray-300 text-center">åºè™Ÿ</th>
                  <th class="p-2 border border-gray-300 text-center">ç—‡ç‹€</th>
                  <th class="p-2 border border-gray-300 text-center">åºè™Ÿ</th>
                  <th class="p-2 border border-gray-300 text-center">ç—‡ç‹€</th>
                </tr>
              </thead>
              <tbody class="bg-white" id="body-language-tbody">
                <!-- JSå‹•æ…‹ç”Ÿæˆå…§å®¹ -->
              </tbody>
            </table>
          </div>
        </div>

        <!-- ç—‡ç‹€èˆ‡å¥åº·è¦ç´ ç¢ºèªè¡¨ï¼ˆä¸€ï¼‰ -->
        <div class="mb-8">
          <h3 class="text-xl font-bold text-gray-800 mb-3 flex items-center">
            <i class="fa fa-check-square-o text-primary mr-2"></i>ç—‡ç‹€èˆ‡å¥åº·è¦ç´ ç¢ºèªè¡¨ï¼ˆä¸€ï¼‰
          </h3>
          <div class="overflow-x-auto rounded-lg border border-gray-200 shadow-sm">
            <table class="w-full border-collapse">
              <thead class="bg-primary text-white">
                <tr>
                  <th class="p-2 border border-gray-300 text-center">åºè™Ÿ</th>
                  <th class="p-2 border border-gray-300 text-center">ç—‡ç‹€</th>
                  <th class="p-2 border border-gray-300 text-center">æ°£è¡€(æ°£è¡€ä¸è¶³)</th>
                  <th class="p-2 border border-gray-300 text-center">å¾®å¾ªç’°ä¸é€š</th>
                  <th class="p-2 border border-gray-300 text-center">æ¯’ç´ </th>
                  <th class="p-2 border border-gray-300 text-center">è¡€è„‚ç²˜ç¨ </th>
                  <th class="p-2 border border-gray-300 text-center">å¯’æ¶¼æ¿•ç—‡</th>
                  <th class="p-2 border border-gray-300 text-center">å…ç–«</th>
                  <th class="p-2 border border-gray-300 text-center">æƒ…ç·’</th>
                </tr>
              </thead>
              <tbody class="bg-white" id="checklist1-tbody">
                <!-- JSå‹•æ…‹ç”Ÿæˆå…§å®¹ -->
              </tbody>
            </table>
          </div>
        </div>

        <!-- ç—‡ç‹€èˆ‡å¥åº·è¦ç´ ç¢ºèªè¡¨ï¼ˆäºŒï¼‰ -->
        <div class="mb-6">
          <h3 class="text-xl font-bold text-gray-800 mb-3 flex items-center">
            <i class="fa fa-check-square-o text-primary mr-2"></i>ç—‡ç‹€èˆ‡å¥åº·è¦ç´ ç¢ºèªè¡¨ï¼ˆäºŒï¼‰
          </h3>
          <div class="overflow-x-auto rounded-lg border border-gray-200 shadow-sm">
            <table class="w-full border-collapse">
              <thead class="bg-primary text-white">
                <tr>
                  <th class="p-2 border border-gray-300 text-center">åºè™Ÿ</th>
                  <th class="p-2 border border-gray-300 text-center">ç—‡ç‹€</th>
                  <th class="p-2 border border-gray-300 text-center">æ°£è¡€(æ°£è¡€ä¸è¶³)</th>
                  <th class="p-2 border border-gray-300 text-center">å¾®å¾ªç’°ä¸é€š</th>
                  <th class="p-2 border border-gray-300 text-center">æ¯’ç´ </th>
                  <th class="p-2 border border-gray-300 text-center">è¡€è„‚ç²˜ç¨ </th>
                  <th class="p-2 border border-gray-300 text-center">å¯’æ¶¼æ¿•ç—‡</th>
                  <th class="p-2 border border-gray-300 text-center">å…ç–«</th>
                  <th class="p-2 border border-gray-300 text-center">æƒ…ç·’</th>
                </tr>
              </thead>
              <tbody class="bg-white" id="checklist2-tbody">
                <!-- JSå‹•æ…‹ç”Ÿæˆå…§å®¹ -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const LIFF_ID = "2008578880-NznKeG2a";
    const GAS_URL = "https://script.google.com/macros/s/AKfycbykBtM2_PM7IZ-ZUU4tgTqVa1xGhVQFaZ523FXc4ivdLz_GZ09sdmL6s5zk7SdloFuG/exec";
    const JSONP_TIMEOUT = 15000;
    const PERMANENT_EXPIRY_DATE = "9999/12/31";

    // è‡ªæª¢è¡¨æ•¸æ“š
    const bodyLanguageSymptoms = [
      ["1", "è¨˜æ†¶åŠ›ä¸‹é™"], ["2", "æ€ç¶­æ–·é›»"], ["3", "åæ‡‰é²éˆ"], ["4", "å—œç¡"], ["5", "å¤šå¤¢"],
      ["6", "é ­æšˆ"], ["7", "é ­ç–¼"], ["8", "é ­éº»"], ["9", "æšˆè»Š"], ["10", "å¤±çœ "],
      ["11", "é ­é¢æ²¹è†©"], ["12", "è„«é«®"], ["13", "é ­é«®ç¨€å°‘"], ["14", "æ˜“æ‰“å“ˆæ¬ "], ["15", "å¸¸å˜†æ°£"],
      ["16", "çœ¼ä¹¾æ¾€"], ["17", "çœ¼ç™¢"], ["18", "çœ¼ç—›"], ["19", "è¦–åŠ›æ¨¡ç³Š"], ["20", "çœ¼å±å¤š"],
      ["21", "çœ¼æ€•å…‰æµæ·š"], ["22", "éº¥ç²’è…«"], ["23", "è½åŠ›ä¸‹é™"], ["24", "è€³ç™¢"], ["25", "è€³é³´"],
      ["26", "è€³ç—›"], ["27", "è€³å±å¤š"], ["28", "è€³å…§æ½®æ¿•"], ["29", "æ‰“é¼¾"], ["30", "é¼»å¡"],
      ["31", "æ„›æ‰“å™´åš"], ["32", "å¸¸æµé»ƒæ¶•"], ["33", "é¼»ç‚"], ["34", "æ„Ÿå†’æ™‚é–“é•·"], ["35", "å—“å­å¹²"],
      ["36", "å–‰åš¨ç™¢"], ["37", "å–‰åš¨ç—›"], ["38", "å’³å—½"], ["39", "ç—°å¤š"], ["40", "å‘¼å¸å›°é›£"],
      ["41", "å£è‹¦"], ["42", "å£å¹²"], ["43", "å£è‡­"], ["44", "å£è…”æ½°ç˜"], ["45", "èˆŒæ½°ç˜"],
      ["46", "å˜´å”‡éº»"], ["47", "èˆŒç¡¬"], ["48", "èƒ¸æ‚¶æ°£çŸ­"], ["49", "å¿ƒæ…Œå¿ƒæ‚¸"], ["50", "å¿ƒçµç—›"],
      ["51", "æŒ‡ç”²å‡¹é™·"], ["52", "åŠæœˆç—•å°‘"], ["53", "æ‰‹è…³è„«çš®"], ["54", "æ‰‹è…³å‡ºæ±—"], ["55", "æ‰‹è…³æ¶¼"],
      ["56", "æ‰‹è…³ç†±"], ["57", "æ‰‹è¶³éº»æœ¨"], ["58", "å››è‚¢ä¹åŠ›"], ["59", "éœè„ˆæ›²å¼µ"], ["60", "é—œç¯€ç—›"],
      ["61", "è‚©é…¸ç—›"], ["62", "é ¸æ¤ç—›"], ["63", "è…°é…¸ç—›"], ["64", "å°¿æ¸¾æ¿"], ["65", "å°¿å¤šæ²«"],
      ["66", "å°¿æœ‰æ€ªå‘³"], ["67", "å¤œå°¿å¤š"], ["68", "ä¾¿ç§˜"], ["69", "å¤§ä¾¿ä¸æˆå½¢"], ["70", "ä¾¿æºä¸æ·¨"],
      ["71", "é«˜è¡€è„‚"], ["72", "é«˜è¡€å£“"], ["73", "é«˜è¡€ç³–"], ["74", "ä½è¡€ç³–"], ["75", "ä½è¡€å£“"],
      ["76", "ç¶“æœŸé ­ç—›"], ["77", "æœˆç¶“é‡å°‘"], ["78", "ç¶“æœŸæ™‚é•·"], ["79", "ç¶“æœŸæ¨å"], ["80", "æœˆç¶“æœ‰è¡€å¡Š"],
      ["81", "ä¹³è…ºå¢ç”Ÿ"], ["82", "ç¶“æœŸè…°ç—›"], ["83", "ç¶“æœŸæå‰"], ["84", "æœˆç¶“é‡å¤š"], ["85", "ä¸æ„›èªªè©±"],
      ["86", "æƒ¡å¿ƒ"], ["87", "èƒƒè„¹"], ["88", "èƒƒé…¸"], ["89", "èƒƒç—›"], ["90", "æ¶ˆåŒ–ä¸è‰¯"],
      ["91", "è‚¥èƒ–"], ["92", "çš®è†šç™¢"], ["93", "æ¿•ç–¹"], ["94", "å„ç¨®éæ•"], ["95", "ç—¤ç˜¡"],
      ["96", "è„‚è‚ªç˜¤"], ["97", "èº«é«”ç•°å‘³"], ["98", "æ·‹å·´çµå¤§"], ["99", "é»‘ç—£è®Šå¤§è®Šå¤š"], ["100", "å½¢é«”æ¶ˆç˜¦"]
    ];

    const healthChecklist1 = [
      {seq: 1, symptom: "è¨˜æ†¶åŠ›ä¸‹é™", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 2, symptom: "æ€ç¶­æ–·é›»", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 3, symptom: "åæ‡‰é²éˆ", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 4, symptom: "å—œç¡", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 5, symptom: "å¤šå¤¢", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: "â—‹"},
      {seq: 6, symptom: "é ­æšˆ", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: "â—‹"},
      {seq: 7, symptom: "é ­ç–¼", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "â—‹", å…ç–«: "", æƒ…ç»ª: "â—‹"},
      {seq: 8, symptom: "é ­éº»", æ°”è¡€: "", å¾®å¾ªç¯: "â—‹", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 9, symptom: "æšˆè»Š", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 10, symptom: "å¤±çœ ", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: "â—‹"},
      {seq: 11, symptom: "é ­é¢æ²¹è†©", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "â—‹", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 12, symptom: "è„«é«®", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 13, symptom: "é ­é«®ç¨€å°‘", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: "â—‹"},
      {seq: 14, symptom: "æ˜“æ‰“å“ˆæ¬ ", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "â—‹", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 15, symptom: "å¸¸å˜†æ°£", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: "â—‹"},
      {seq: 16, symptom: "çœ¼ä¹¾æ¾€", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 17, symptom: "çœ¼ç™¢", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "â—‹", æƒ…ç»ª: ""},
      {seq: 18, symptom: "çœ¼ç—›", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "â—‹", æƒ…ç»ª: ""},
      {seq: 19, symptom: "è¦–åŠ›æ¨¡ç³Š", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 20, symptom: "çœ¼å±å¤š", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 21, symptom: "çœ¼æ€•å…‰æµæ·š", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 22, symptom: "éº¥ç²’è…«", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 23, symptom: "è½åŠ›ä¸‹é™", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: "â—‹"},
      {seq: 24, symptom: "è€³ç™¢", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "â—‹", æƒ…ç»ª: ""},
      {seq: 25, symptom: "è€³é³´", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: "â—‹"},
      {seq: 26, symptom: "è€³ç—›", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 27, symptom: "è€³å±å¤š", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 28, symptom: "è€³å…§æ½®æ¿•", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "â—‹", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 29, symptom: "æ‰“é¼¾", æ°”è¡€: "", å¾®å¾ªç¯: "â—‹", æ¯’ç´ : "", è¡€è„‚: "â—‹", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 30, symptom: "é¼»å¡", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "â—‹", å…ç–«: "â—‹", æƒ…ç»ª: ""},
      {seq: 31, symptom: "æ„›æ‰“å™´åš", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "â—‹", å…ç–«: "â—‹", æƒ…ç»ª: ""},
      {seq: 32, symptom: "å¸¸æµé»ƒæ¶•", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "â—‹", å…ç–«: "â—‹", æƒ…ç»ª: ""},
      {seq: 33, symptom: "é¼»ç‚", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "â—‹", å…ç–«: "â—‹", æƒ…ç»ª: ""},
      {seq: 34, symptom: "æ„Ÿå†’æ™‚é–“é•·", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "â—‹", å…ç–«: "â—‹", æƒ…ç»ª: ""},
      {seq: 35, symptom: "å—“å­å¹²", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 36, symptom: "å–‰åš¨ç™¢", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "â—‹", æƒ…ç»ª: ""},
      {seq: 37, symptom: "å–‰åš¨ç—›", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "â—‹", æƒ…ç»ª: "â—‹"},
      {seq: 38, symptom: "å’³å—½", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "â—‹", å…ç–«: "â—‹", æƒ…ç»ª: ""},
      {seq: 39, symptom: "ç—°å¤š", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "â—‹", å…ç–«: "â—‹", æƒ…ç»ª: ""},
      {seq: 40, symptom: "å‘¼å¸å›°é›£", æ°”è¡€: "", å¾®å¾ªç¯: "â—‹", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "â—‹", å…ç–«: "â—‹", æƒ…ç»ª: ""},
      {seq: 41, symptom: "å£è‹¦", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 42, symptom: "å£å¹²", æ°”è¡€: "", å¾®å¾ªç¯: "â—‹", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 43, symptom: "å£è‡­", æ°”è¡€: "", å¾®å¾ªç¯: "â—‹", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 44, symptom: "å£è…”æ½°ç˜", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "â—‹", æƒ…ç»ª: ""},
      {seq: 45, symptom: "èˆŒæ½°ç˜", æ°”è¡€: "", å¾®å¾ªç¯: "â—‹", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: "â—‹"},
      {seq: 46, symptom: "å˜´å”‡éº»", æ°”è¡€: "", å¾®å¾ªç¯: "â—‹", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 47, symptom: "èˆŒç¡¬", æ°”è¡€: "", å¾®å¾ªç¯: "â—‹", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 48, symptom: "èƒ¸æ‚¶æ°£çŸ­", æ°”è¡€: "", å¾®å¾ªç¯: "â—‹", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 49, symptom: "å¿ƒæ…Œå¿ƒæ‚¸", æ°”è¡€: "", å¾®å¾ªç¯: "â—‹", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 50, symptom: "å¿ƒçµç—›", æ°”è¡€: "", å¾®å¾ªç¯: "â—‹", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""}
    ];

    const healthChecklist2 = [
      {seq: 51, symptom: "æŒ‡ç”²å‡¹é™·", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 52, symptom: "åŠæœˆç—•å°‘", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 53, symptom: "æ‰‹è…³è„«çš®", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 54, symptom: "æ‰‹è…³å‡ºæ±—", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "â—‹", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 55, symptom: "æ‰‹è…³æ¶¼", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "â—‹", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 56, symptom: "æ‰‹è…³ç†±", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 57, symptom: "æ‰‹è¶³éº»æœ¨", æ°”è¡€: "", å¾®å¾ªç¯: "â—‹", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 58, symptom: "å››è‚¢ä¹åŠ›", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 59, symptom: "éœè„ˆæ›²å¼µ", æ°”è¡€: "", å¾®å¾ªç¯: "â—‹", æ¯’ç´ : "", è¡€è„‚: "â—‹", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 60, symptom: "é—œç¯€ç—›", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "â—‹", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 61, symptom: "è‚©é…¸ç—›", æ°”è¡€: "", å¾®å¾ªç¯: "â—‹", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "â—‹", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 62, symptom: "é ¸æ¤ç—›", æ°”è¡€: "", å¾®å¾ªç¯: "â—‹", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "â—‹", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 63, symptom: "è…°é…¸ç—›", æ°”è¡€: "", å¾®å¾ªç¯: "â—‹", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "â—‹", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 64, symptom: "å°¿æ¸¾æ¿", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 65, symptom: "å°¿å¤šæ²«", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 66, symptom: "å°¿æœ‰æ€ªå‘³", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 67, symptom: "å¤œå°¿å¤š", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "â—‹", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 68, symptom: "ä¾¿ç§˜", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: "â—‹"},
      {seq: 69, symptom: "å¤§ä¾¿ä¸æˆå½¢", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "â—‹", å…ç–«: "", æƒ…ç»ª: "â—‹"},
      {seq: 70, symptom: "ä¾¿æºä¸æ·¨", æ°”è¡€: "", å¾®å¾ªç¯: "â—‹", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 71, symptom: "é«˜è¡€è„‚", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "â—‹", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 72, symptom: "é«˜è¡€å£“", æ°”è¡€: "", å¾®å¾ªç¯: "â—‹", æ¯’ç´ : "", è¡€è„‚: "â—‹", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 73, symptom: "é«˜è¡€ç³–", æ°”è¡€: "", å¾®å¾ªç¯: "â—‹", æ¯’ç´ : "", è¡€è„‚: "â—‹", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 74, symptom: "ä½è¡€ç³–", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 75, symptom: "ä½è¡€å£“", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 76, symptom: "ç¶“æœŸé ­ç—›", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 77, symptom: "æœˆç¶“é‡å°‘", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 78, symptom: "ç¶“æœŸæ™‚é•·", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 79, symptom: "ç¶“æœŸæ¨å", æ°”è¡€: "", å¾®å¾ªç¯: "â—‹", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "â—‹", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 80, symptom: "æœˆç¶“æœ‰è¡€å¡Š", æ°”è¡€: "", å¾®å¾ªç¯: "â—‹", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "â—‹", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 81, symptom: "ä¹³è…ºå¢ç”Ÿ", æ°”è¡€: "", å¾®å¾ªç¯: "â—‹", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "â—‹", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 82, symptom: "ç¶“æœŸè…°ç—›", æ°”è¡€: "", å¾®å¾ªç¯: "â—‹", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "â—‹", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 83, symptom: "ç¶“æœŸæå‰", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: "â—‹"},
      {seq: 84, symptom: "æœˆç¶“é‡å¤š", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: "â—‹"},
      {seq: 85, symptom: "ä¸æ„›èªªè©±", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 86, symptom: "æƒ¡å¿ƒ", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 87, symptom: "èƒƒè„¹", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 88, symptom: "èƒƒé…¸", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 89, symptom: "èƒƒç—›", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "â—‹", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 90, symptom: "æ¶ˆåŒ–ä¸è‰¯", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 91, symptom: "è‚¥èƒ–", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "â—‹", å¯’å‡‰æ¹¿: "â—‹", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 92, symptom: "çš®è†šç™¢", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 93, symptom: "æ¿•ç–¹", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "â—‹", å…ç–«: "â—‹", æƒ…ç»ª: ""},
      {seq: 94, symptom: "å„ç¨®éæ•", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "â—‹", æƒ…ç»ª: ""},
      {seq: 95, symptom: "ç—¤ç˜¡", æ°”è¡€: "", å¾®å¾ªç¯: "â—‹", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 96, symptom: "è„‚è‚ªç˜¤", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "â—‹", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 97, symptom: "èº«é«”ç•°å‘³", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""},
      {seq: 98, symptom: "æ·‹å·´çµå¤§", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "â—‹", æƒ…ç»ª: ""},
      {seq: 99, symptom: "é»‘ç—£è®Šå¤§è®Šå¤š", æ°”è¡€: "", å¾®å¾ªç¯: "", æ¯’ç´ : "â—‹", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "â—‹", æƒ…ç»ª: ""},
      {seq: 100, symptom: "å½¢é«”æ¶ˆç˜¦", æ°”è¡€: "â—‹", å¾®å¾ªç¯: "", æ¯’ç´ : "", è¡€è„‚: "", å¯’å‡‰æ¹¿: "", å…ç–«: "", æƒ…ç»ª: ""}
    ];

    // æ¸²æŸ“èº«é«”èªè¨€ç°¡è¡¨ - ç¢ºä¿æ•¸æ“šæ­£ç¢ºæ¸²æŸ“
    function renderBodyLanguageTable() {
      try {
        const tbody = document.getElementById('body-language-tbody');
        if (!tbody) {
          console.error("èº«é«”èªè¨€ç°¡è¡¨ tbody å…ƒç´ æœªæ‰¾åˆ°");
          return false;
        }
        
        let rows = '';
        if (bodyLanguageSymptoms.length < 100) {
          console.error("èº«é«”èªè¨€ç°¡è¡¨æ•¸æ“šä¸è¶³ 100 æ¢");
          tbody.innerHTML = `<tr><td colspan="10" class="p-4 text-center text-red-500">æ•¸æ“šåŠ è¼‰éŒ¯èª¤</td></tr>`;
          return false;
        }

        for (let i = 0; i < 20; i++) {
          const items = [
            bodyLanguageSymptoms[i],
            bodyLanguageSymptoms[i + 20],
            bodyLanguageSymptoms[i + 40],
            bodyLanguageSymptoms[i + 60],
            bodyLanguageSymptoms[i + 80]
          ];
          rows += `<tr class="table-hover-row">`;
          items.forEach(item => {
            rows += `<td class="p-2 border border-gray-300 text-center">${item[0]}</td>`;
            rows += `<td class="p-2 border border-gray-300 text-left">${item[1]}</td>`;
          });
          rows += `</tr>`;
        }
        tbody.innerHTML = rows;
        console.log("èº«é«”èªè¨€ç°¡è¡¨æ¸²æŸ“å®Œæˆ");
        return true;
      } catch (error) {
        console.error("æ¸²æŸ“èº«é«”èªè¨€ç°¡è¡¨å‡ºéŒ¯ï¼š", error);
        const tbody = document.getElementById('body-language-tbody');
        if (tbody) {
          tbody.innerHTML = `<tr><td colspan="10" class="p-4 text-center text-red-500">æ¸²æŸ“éŒ¯èª¤ï¼š${error.message}</td></tr>`;
        }
        return false;
      }
    }

    // æ¸²æŸ“å¥åº·è¦ç´ ç¢ºèªè¡¨ - ç¢ºä¿æ•¸æ“šæ­£ç¢ºæ¸²æŸ“
    function renderHealthChecklistTable(data, tbodyId) {
      try {
        const tbody = document.getElementById(tbodyId);
        if (!tbody) {
          console.error(`å¥åº·è¦ç´ ç¢ºèªè¡¨ tbody å…ƒç´  ${tbodyId} æœªæ‰¾åˆ°`);
          return false;
        }
        
        if (!data || data.length === 0) {
          console.error(`å¥åº·è¦ç´ ç¢ºèªè¡¨æ•¸æ“šç‚ºç©º`);
          tbody.innerHTML = `<tr><td colspan="9" class="p-4 text-center text-red-500">æ•¸æ“šåŠ è¼‰éŒ¯èª¤</td></tr>`;
          return false;
        }

        let rows = '';
        data.forEach(item => {
          rows += `<tr class="table-hover-row">
            <td class="p-2 border border-gray-300 text-center">${item.seq}</td>
            <td class="p-2 border border-gray-300 text-left">${item.symptom}</td>
            <td class="p-2 border border-gray-300 text-center">${item.æ°”è¡€}</td>
            <td class="p-2 border border-gray-300 text-center">${item.å¾®å¾ªç¯}</td>
            <td class="p-2 border border-gray-300 text-center">${item.æ¯’ç´ }</td>
            <td class="p-2 border border-gray-300 text-center">${item.è¡€è„‚}</td>
            <td class="p-2 border border-gray-300 text-center">${item.å¯’å‡‰æ¹¿}</td>
            <td class="p-2 border border-gray-300 text-center">${item.å…ç–«}</td>
            <td class="p-2 border border-gray-300 text-center">${item.æƒ…ç»ª}</td>
          </tr>`;
        });
        tbody.innerHTML = rows;
        console.log(`${tbodyId} æ¸²æŸ“å®Œæˆï¼Œå…± ${data.length} æ¢æ•¸æ“š`);
        return true;
      } catch (error) {
        console.error(`æ¸²æŸ“ ${tbodyId} å‡ºéŒ¯ï¼š`, error);
        const tbody = document.getElementById(tbodyId);
        if (tbody) {
          tbody.innerHTML = `<tr><td colspan="9" class="p-4 text-center text-red-500">æ¸²æŸ“éŒ¯èª¤ï¼š${error.message}</td></tr>`;
        }
        return false;
      }
    }

    // ç‹€æ…‹è¨­ç½®å‡½æ•¸
    const setStatus = text => {
      const statusText = document.getElementById('status-text');
      if (statusText) statusText.textContent = text;
    };

    // éŒ¯èª¤é¡¯ç¤ºå‡½æ•¸
    const showError = msg => {
      document.getElementById('status').classList.add('hidden');
      document.getElementById('result-card').classList.add('hidden');
      document.getElementById('checklist-section').classList.add('hidden');
      
      const el = document.getElementById('error-message');
      if (el) {
        el.innerHTML = `<p>${msg}</p><div class="mt-3 flex justify-center">
          <button onclick="window.location.reload()" class="text-primary hover:text-primary/80 font-medium">
            <i class="fa fa-refresh mr-1"></i> é‡æ–°å˜—è©¦
          </button></div>`;
        el.classList.remove('hidden');
      }
    };

    // è¨ˆç®—å‰©é¤˜å¤©æ•¸å‡½æ•¸
    const calculateRemainingDaysByDate = (expiryDateStr) => {
      try {
        if (expiryDateStr === PERMANENT_EXPIRY_DATE) {
          return { displayDate: "æ°¸ä¹…æœ‰æ•ˆ", remainingDays: "æ°¸ä¹…æœ‰æ•ˆ" };
        }

        const dateRegex = /^\d{4}[-\/]\d{2}[-\/]\d{2}$/;
        if (!dateRegex.test(expiryDateStr)) {
          return { displayDate: "æ ¼å¼éŒ¯èª¤", remainingDays: "æ ¼å¼éŒ¯èª¤" };
        }

        const normalizedDateStr = expiryDateStr.replace(/-/g, '/');
        const [year, month, day] = normalizedDateStr.split('/').map(Number);
        
        const expiryDate = new Date(Date.UTC(year, month - 1, day));
        const today = new Date();
        const todayUTC = new Date(Date.UTC(today.getFullYear(), today.getMonth(), today.getDate()));

        if (isNaN(expiryDate.getTime())) {
          return { displayDate: "æ—¥æœŸç„¡æ•ˆ", remainingDays: "æ—¥æœŸç„¡æ•ˆ" };
        }

        const timeDiff = expiryDate - todayUTC;
        const remainingDays = Math.ceil(timeDiff / (1000 * 3600 * 24));

        const formattedDate = `${year}/${String(month).padStart(2, '0')}/${String(day).padStart(2, '0')}`;
        let remainingDaysText;
        
        if (remainingDays < 0) {
          remainingDaysText = "å·²éæœŸ";
        } else if (remainingDays === 0) {
          remainingDaysText = "æœ€å¾Œ1å¤©";
        } else {
          remainingDaysText = `${remainingDays} å¤©`;
        }

        return { displayDate: formattedDate, remainingDays: remainingDaysText };
      } catch (error) {
        console.error("åŸºæ–¼æ—¥æœŸè¨ˆç®—å‰©é¤˜å¤©æ•¸å¤±æ•—ï¼š", error, "æ—¥æœŸå­—ç¬¦ä¸²ï¼š", expiryDateStr);
        return { displayDate: "è¨ˆç®—éŒ¯èª¤", remainingDays: "è¨ˆç®—éŒ¯èª¤" };
      }
    };

    // å¼·åˆ¶é¡¯ç¤ºè‡ªæª¢è¡¨å€åŸŸ
    function forceShowChecklist() {
      try {
        const checklistSection = document.getElementById('checklist-section');
        if (!checklistSection) {
          console.error("è‡ªæª¢è¡¨å€åŸŸå…ƒç´ æœªæ‰¾åˆ°");
          alert("è‡ªæª¢è¡¨åŠ è¼‰å¤±æ•—ï¼Œè«‹åˆ·æ–°é é¢é‡è©¦");
          return false;
        }

        // ç§»é™¤hiddené¡ï¼Œç¢ºä¿é¡¯ç¤º
        checklistSection.classList.remove('hidden');
        checklistSection.style.display = 'block'; // å¼·åˆ¶é¡¯ç¤ºï¼Œé˜²æ­¢CSSå½±éŸ¿
        
        // æ»¾å‹•åˆ°è‡ªæª¢è¡¨å€åŸŸ
        setTimeout(() => {
          checklistSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }, 100);
        
        console.log("è‡ªæª¢è¡¨å€åŸŸå·²å¼·åˆ¶é¡¯ç¤º");
        return true;
      } catch (error) {
        console.error("å¼·åˆ¶é¡¯ç¤ºè‡ªæª¢è¡¨å‡ºéŒ¯ï¼š", error);
        alert("è‡ªæª¢è¡¨é¡¯ç¤ºå¤±æ•—ï¼Œè«‹åˆ·æ–°é é¢é‡è©¦");
        return false;
      }
    }

    // é é¢åŠ è¼‰å®Œæˆå¾Œåˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', function() {
      console.log("é é¢åŠ è¼‰å®Œæˆï¼Œé–‹å§‹åˆå§‹åŒ–");

      // åˆå§‹åŒ– LIFF
      setStatus('æ­£åœ¨åˆå§‹åŒ– LIFF...');
      liff.init({ liffId: LIFF_ID }, { disableRedirect: true })
        .then(() => {
          console.log("LIFF åˆå§‹åŒ–æˆåŠŸ");
          if (!liff.isLoggedIn()) {
            console.log("ç”¨æˆ¶æœªç™»éŒ„ï¼Œè·³è½‰ç™»éŒ„");
            liff.login();
          } else {
            console.log("ç”¨æˆ¶å·²ç™»éŒ„ï¼Œé–‹å§‹é©—è­‰ä¿¡æ¯");
            getProfileAndVerify();
          }
        })
        .catch(err => {
          console.error("LIFF åˆå§‹åŒ–å¤±æ•—ï¼š", err);
          showError('ç³»çµ±åˆå§‹åŒ–å¤±æ•—ï¼š' + err.message);
        });
    });

    // ç²å–ç”¨æˆ¶ä¿¡æ¯ä¸¦é©—è­‰
    function getProfileAndVerify() {
      setStatus('é©—è­‰ä½¿ç”¨è€…è³‡è¨Šä¸­...');
      liff.getProfile()
        .then(profile => {
          console.log("ç²å–ç”¨æˆ¶ä¿¡æ¯æˆåŠŸï¼š", profile);
          callGasBackend(profile.userId, profile.displayName || 'æœªçŸ¥ç”¨æˆ¶');
        })
        .catch(err => {
          console.error("ç²å–ä½¿ç”¨è€…è³‡æ–™å¤±æ•—ï¼š", err);
          showError('å–å¾—ä½¿ç”¨è€…è³‡æ–™å¤±æ•—ï¼š' + err.message);
        });
    }

    // èª¿ç”¨GASå¾Œç«¯
    function callGasBackend(userId, displayName) {
      console.log("èª¿ç”¨å¾Œç«¯é©—è­‰ç”¨æˆ¶ï¼š", userId, displayName);
      $.ajax({
        url: GAS_URL,
        dataType: 'jsonp',
        jsonp: 'callback',
        timeout: JSONP_TIMEOUT,
        data: { 
          userId: userId, 
          displayName: displayName,
          action: 'verifyUser',
          needExpiryDate: true
        },
        success: function(resp) {
          console.log("å¾Œç«¯è¿”å›æ•¸æ“šï¼š", resp);
          if (resp.status === "error") {
            showError(resp.message);
          } else {
            renderResult(resp);
          }
        },
        error: function(xhr, status, error) {
          console.error("AJAX éŒ¯èª¤ï¼š", status, error);
          let errorMsg = 'èˆ‡ä¼ºæœå™¨é€šè¨Šå¤±æ•—';
          if (status === 'timeout') errorMsg = 'è«‹æ±‚è¶…æ™‚ï¼Œè«‹æª¢æŸ¥ç¶²çµ¡é€£æ¥';
          else if (status === 'parsererror') errorMsg = 'æ•¸æ“šè§£æéŒ¯èª¤';
          showError(errorMsg);
        }
      });
    }

    // æ¸²æŸ“é©—è­‰çµæœå’Œè‡ªæª¢è¡¨ï¼ˆæ ¸å¿ƒä¿®æ­£ï¼‰
    function renderResult(resp) {
      console.log("é–‹å§‹æ¸²æŸ“é©—è­‰çµæœå’Œè‡ªæª¢è¡¨");
      
      // éš±è—ç‹€æ…‹å’ŒéŒ¯èª¤ä¿¡æ¯
      document.getElementById('status').classList.add('hidden');
      document.getElementById('error-message').classList.add('hidden');

      // æ¸²æŸ“çµæœå¡ç‰‡
      const card = document.getElementById('result-card');
      const main = document.getElementById('result-main');
      const details = document.getElementById('result-details');

      const isProUser = resp.isAdmin === true;
      const userName = resp.displayName || 'æœªçŸ¥ç”¨æˆ¶';
      const expiryDateStr = resp.expiryDate || resp.endDate || resp.expireDate || '';

      if (isProUser) {
        const { displayDate, remainingDays } = calculateRemainingDaysByDate(expiryDateStr);
        main.innerHTML = `<span class="text-primary"><i class="fa fa-check-circle mr-1"></i>å°ˆæ¥­ç”¨æˆ¶é©—è­‰é€šé</span>`;
        details.innerHTML = `ç”¨æˆ¶åç¨±ï¼š${userName}<br>
                           ä½¿ç”¨æœŸé™ï¼š${displayDate}<br>
                           å‰©é¤˜å¤©æ•¸ï¼š${remainingDays}`;
      } else {
        const usageCount = resp.usageCount || 0;
        const remainingTimes = Math.max(0, 3 - usageCount);
        
        // æ™®é€šç”¨æˆ¶å‰©é¤˜æ¬¡æ•¸ç‚º0æ™‚ï¼Œé¡¯ç¤ºéŒ¯èª¤ä¿¡æ¯
        if (remainingTimes <= 0) {
          main.innerHTML = `<span class="text-orange-600"><i class="fa fa-exclamation-circle mr-1"></i>æ™®é€šç”¨æˆ¶ä½¿ç”¨æ¬¡æ•¸å·²ç”¨å®Œ</span>`;
          details.innerHTML = `ç”¨æˆ¶åç¨±ï¼š${userName}<br>
                             ä½¿ç”¨æœŸé™ï¼š-<br>
                             å‰©é¤˜æ¬¡æ•¸ï¼š${remainingTimes} æ¬¡<br>
                             æç¤ºï¼šè«‹è¯ç¹«ç®¡ç†å“¡å‡ç´šç‚ºå°ˆæ¥­ç”¨æˆ¶ç¹¼çºŒä½¿ç”¨`;
          
          // é¡¯ç¤ºçµæœå¡ç‰‡
          card.classList.remove('hidden');
          return; // çµ‚æ­¢åŸ·è¡Œï¼Œä¸é¡¯ç¤ºè‡ªæª¢è¡¨
        } else {
          main.innerHTML = `<span class="text-gray-600"><i class="fa fa-user mr-1"></i>æ™®é€šç”¨æˆ¶é©—è­‰é€šé</span>`;
          details.innerHTML = `ç”¨æˆ¶åç¨±ï¼š${userName}<br>
                             ä½¿ç”¨æœŸé™ï¼š-<br>
                             å‰©é¤˜æ¬¡æ•¸ï¼š${remainingTimes} æ¬¡`;
        }
      }

      // é¡¯ç¤ºçµæœå¡ç‰‡
      card.classList.remove('hidden');
      console.log("çµæœå¡ç‰‡å·²é¡¯ç¤º");

      // æ¸²æŸ“è‡ªæª¢è¡¨æ•¸æ“šï¼ˆåŒæ­¥åŸ·è¡Œï¼Œç¢ºä¿æ•¸æ“šæ¸²æŸ“å®Œæˆï¼‰
      console.log("é–‹å§‹æ¸²æŸ“è‡ªæª¢è¡¨æ•¸æ“š");
      const render1 = renderBodyLanguageTable();
      const render2 = renderHealthChecklistTable(healthChecklist1, 'checklist1-tbody');
      const render3 = renderHealthChecklistTable(healthChecklist2, 'checklist2-tbody');

      // ç„¡è«–æ¸²æŸ“æ˜¯å¦æˆåŠŸï¼Œéƒ½å˜—è©¦é¡¯ç¤ºè‡ªæª¢è¡¨å€åŸŸ
      if (render1 && render2 && render3) {
        console.log("æ‰€æœ‰è‡ªæª¢è¡¨æ•¸æ“šæ¸²æŸ“æˆåŠŸï¼Œæº–å‚™é¡¯ç¤º");
        // å»¶é²çŸ­æ™‚é–“å¾Œé¡¯ç¤ºï¼Œç¢ºä¿DOMæ›´æ–°å®Œæˆ
        setTimeout(() => {
          forceShowChecklist();
        }, 100);
      } else {
        console.warn("éƒ¨åˆ†è‡ªæª¢è¡¨æ•¸æ“šæ¸²æŸ“å¤±æ•—ï¼Œå˜—è©¦å¼·åˆ¶é¡¯ç¤º");
        // å³ä½¿éƒ¨åˆ†æ¸²æŸ“å¤±æ•—ï¼Œä¹Ÿå˜—è©¦é¡¯ç¤º
        setTimeout(() => {
          forceShowChecklist();
        }, 100);
      }
    }
  </script>
</body>
</html>
