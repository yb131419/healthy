<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>ğŸ§¬ å½¥å½¬ è‡ªæª¢è¡¨ç³»çµ± - å°ˆæ¥­å¥åº·è©•ä¼°å¹³å°</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0">
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
<script>
tailwind.config={theme:{extend:{colors:{primary:'#008C76',secondary:'#E8F9F7',accent:'#FFD700',dark:'#1A202C',lightBg:'#F9FAFB',neutral:'#F3F4F6',cardBg:'#FFFFFF',textPrimary:'#1E293B',textSecondary:'#64748B'},fontFamily:{sans:['Noto Sans TC','sans-serif','system-ui'],display:['Noto Sans TC','sans-serif','system-ui']},boxShadow:{'elevation-1':'0 2px 8px rgba(0, 0, 0, 0.06)','elevation-2':'0 4px 16px rgba(0, 0, 0, 0.08)','elevation-3':'0 8px 24px rgba(0, 0, 0, 0.12)','elevation-hover':'0 12px 32px rgba(0, 0, 0, 0.15)'}}}};
</script>
<style type="text/tailwindcss">
@layer utilities{.fade-in{animation:fadeIn 0.6s cubic-bezier(0.4,0,0.2,1);}.slide-up{animation:slideUp 0.5s cubic-bezier(0.34,1.56,0.64,1);}.scale-in{animation:scaleIn 0.4s cubic-bezier(0.34,1.56,0.64,1);}.pulse-subtle{animation:pulseSubtle 2s infinite;}.gradient-text{background-clip:text;-webkit-background-clip:text;color:transparent;}.card-hover{transition:all 0.3s cubic-bezier(0.34,1.56,0.64,1);}.btn-hover{transition:all 0.25s cubic-bezier(0.34,1.56,0.64,1);}.factor-tag{font-size:0.75rem;padding:0.2rem 0.4rem;border-radius:6px;font-weight:500;}.input-focus{@apply focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-all;}}
@keyframes fadeIn{from{opacity:0;}to{opacity:1;}}
@keyframes slideUp{from{transform:translateY(30px);opacity:0;}to{transform:translateY(0);opacity:1;}}
@keyframes scaleIn{from{transform:scale(0.96);opacity:0;}to{transform:scale(1);opacity:1;}}
@keyframes pulseSubtle{0%,100%{opacity:1;}50%{opacity:0.8;}}
::-webkit-scrollbar{width:8px;height:8px;}
::-webkit-scrollbar-track{background:#F1F5F9;border-radius:4px;}
::-webkit-scrollbar-thumb{background:#CBD5E1;border-radius:4px;}
::-webkit-scrollbar-thumb:hover{background:#94A3B8;}
body{font-feature-settings:"palt";letter-spacing:0.02em;}
.symptom-card{min-height:120px;}
@media (max-width:640px){
.symptom-card{min-height:110px;}
.factor-tag{font-size:0.7rem;padding:0.15rem 0.3rem;}
#symptoms-container{gap:2px;}
.btn-hover{transform:scale(1.02);}
.result-summary{font-size:0.9rem;}
.info-grid{grid-template-columns:repeat(2,1fr);gap:0.5rem;}
}
.info-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:0.75rem;}
.info-item{display:flex;justify-content:space-between;}
.severity-note{font-size:0.65rem;color:#94A3B8;margin-top:2px;}
</style>
</head>
<body class="bg-lightBg min-h-screen flex flex-col p-2 md:p-4">
<div class="max-w-5xl w-full bg-cardBg rounded-2xl shadow-elevation-2 overflow-hidden fade-in self-center">
<div class="bg-gradient-to-r from-primary to-[#006658] p-4 md:p-6 text-white text-center relative overflow-hidden">
<div class="absolute top-0 left-0 w-32 h-32 bg-white/5 rounded-full -translate-x-1/2 -translate-y-1/2"></div>
<div class="absolute bottom-0 right-0 w-48 h-48 bg-white/5 rounded-full translate-x-1/3 translate-y-1/3"></div>
<div class="relative z-10">
<div class="inline-flex items-center justify-center w-14 h-14 bg-white/10 backdrop-blur-sm rounded-full mb-3 pulse-subtle">
<i class="fa fa-heartbeat text-2xl text-accent"></i>
</div>
<h1 class="text-xl md:text-2xl font-bold mb-1 tracking-wide">ğŸ§¬ å½¥å½¬ è‡ªæª¢è¡¨ç³»çµ±</h1>
<p class="text-white/90 text-sm md:text-base font-light">å°ˆæ¥­å¥åº·è©•ä¼° Â· ç²¾æº–å°æ‡‰ä¸ƒå¤§å¥åº·è¦ç´ </p>
</div>
</div>
<div class="p-3 md:p-5">
<div id="status" class="flex items-center justify-center py-6 text-textPrimary text-center">
<div class="text-center">
<div class="inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary mb-3"></div>
<p id="status-text" class="text-base">æ­£åœ¨åˆå§‹åŒ–ç³»çµ±ï¼Œè«‹ç¨å€™...</p>
</div>
</div>
<div id="error-message" class="hidden bg-red-50 border border-red-100 text-red-700 px-4 py-3 rounded-xl mb-4 shadow-sm">
<div class="flex items-start">
<i class="fa fa-exclamation-circle text-red-500 mt-1 mr-2 text-lg"></i>
<div id="error-content"></div>
</div>
</div>
<div id="result-card" class="hidden bg-gradient-to-r from-secondary to-[#F0FAF8] border border-primary/15 rounded-2xl p-4 mb-4 text-center slide-up relative overflow-hidden">
<div class="absolute top-0 right-0 w-24 h-24 bg-primary/5 rounded-full translate-x-1/2 -translate-y-1/2"></div>
<div class="relative z-10">
<div id="result-main" class="text-lg md:text-xl font-bold mb-2 text-textPrimary"></div>
<div id="result-details" class="text-sm text-textSecondary space-y-1 md:space-y-1.5"></div>
<div class="w-20 h-0.5 bg-primary/20 mx-auto my-2"></div>
<p class="text-xs text-textSecondary/80"><i class="fa fa-info-circle text-primary mr-1"></i>è«‹æ ¹æ“šè‡ªèº«ç‹€æ³å¦‚å¯¦å¡«å¯«ï¼Œç³»çµ±å°‡ç‚ºæ‚¨æä¾›å°ˆæ¥­åƒè€ƒ</p>
</div>
</div>
<div id="user-info-section" class="hidden scale-in bg-neutral rounded-2xl p-3 md:p-4 mb-4 shadow-elevation-1">
<div class="text-center mb-3">
<h2 class="text-lg md:text-xl font-bold text-textPrimary mb-1"><span class="gradient-text bg-gradient-to-r from-primary to-[#006658]">ç”¨æˆ¶åŸºæœ¬è³‡è¨Š</span></h2>
<p class="text-textSecondary max-w-2xl mx-auto text-xs">è«‹æ ¹æ“šå¯¦éš›æƒ…æ³å¡«å¯«ï¼Œå¹«åŠ©ç³»çµ±ç²¾ç¢ºè©•ä¼°</p>
</div>
<div class="grid grid-cols-1 md:grid-cols-2 gap-2 mb-3">
<div class="space-y-1">
<label class="block text-xs font-medium text-textPrimary">å§“å <span class="text-red-500">*</span></label>
<input type="text" id="user-name" class="w-full border border-gray-200 rounded-lg px-2 py-1.5 text-sm input-focus bg-white" placeholder="è«‹è¼¸å…¥çœŸå¯¦å§“å" required>
</div>
<div class="space-y-1">
<label class="block text-xs font-medium text-textPrimary">å¹´é½¡ <span class="text-red-500">*</span></label>
<input type="number" id="user-age" min="0" max="120" class="w-full border border-gray-200 rounded-lg px-2 py-1.5 text-sm input-focus bg-white" placeholder="è«‹è¼¸å…¥å¹´é½¡" required>
</div>
<div class="space-y-1">
<label class="block text-xs font-medium text-textPrimary">æ€§åˆ¥ <span class="text-red-500">*</span></label>
<select id="user-gender" class="w-full border border-gray-200 rounded-lg px-2 py-1.5 text-sm input-focus bg-white" required>
<option value="">è«‹é¸æ“‡æ€§åˆ¥</option>
<option value="male">ç”·</option>
<option value="female">å¥³</option>
</select>
</div>
<div class="space-y-1">
<label class="block text-xs font-medium text-textPrimary">èº«é«˜ (cm)</label>
<input type="number" id="user-height" min="50" max="250" class="w-full border border-gray-200 rounded-lg px-2 py-1.5 text-sm input-focus bg-white" placeholder="é¸å¡«">
</div>
<div class="space-y-1">
<label class="block text-xs font-medium text-textPrimary">é«”é‡ (kg)</label>
<input type="number" id="user-weight" min="10" max="200" step="0.1" class="w-full border border-gray-200 rounded-lg px-2 py-1.5 text-sm input-focus bg-white" placeholder="é¸å¡«">
</div>
<div class="space-y-1">
<label class="block text-xs font-medium text-textPrimary">è¡€å£“ (mmHg)</label>
<input type="text" id="user-bp" class="w-full border border-gray-200 rounded-lg px-2 py-1.5 text-sm input-focus bg-white" placeholder="é¸å¡«ï¼Œä¾‹ï¼š120/80">
</div>
<div class="space-y-1">
<label class="block text-xs font-medium text-textPrimary">ç³–åŒ–è¡€è‰²ç´  (%)</label>
<input type="number" id="user-glucose" min="3" max="15" step="0.1" class="w-full border border-gray-200 rounded-lg px-2 py-1.5 text-sm input-focus bg-white" placeholder="é¸å¡«">
</div>
<div class="space-y-1">
<label class="block text-xs font-medium text-textPrimary">è·æ¥­</label>
<input type="text" id="user-job" class="w-full border border-gray-200 rounded-lg px-2 py-1.5 text-sm input-focus bg-white" placeholder="é¸å¡«">
</div>
</div>
<div class="text-center">
<button id="next-to-checklist" class="bg-gradient-to-r from-primary to-[#006658] hover:from-[#007A69] hover:to-[#00594D] text-white font-bold py-2 px-5 rounded-xl shadow-elevation-2 transition btn-hover transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-primary/50">
<i class="fa fa-arrow-right mr-1.5"></i>ç¹¼çºŒå¡«å¯«è‡ªæª¢è¡¨
</button>
</div>
</div>
<div id="checklist-section" class="hidden scale-in">
<div class="mb-3 text-center">
<h2 class="text-lg md:text-xl font-bold text-textPrimary mb-1"><span class="gradient-text bg-gradient-to-r from-primary to-[#006658]">è‡ªæª¢è¡¨å¡«å¯«å€åŸŸ</span></h2>
<p class="text-textSecondary max-w-2xl mx-auto mb-2 text-xs">è«‹å‹¾é¸å°æ‡‰ç—‡ç‹€ä¸¦å¡«å¯«ç›¸é—œè³‡è¨Š</p>
<div class="mt-2 flex flex-wrap justify-center gap-1.5 text-xs">
<span class="bg-blue-50 text-blue-700 factor-tag">æ°£è¡€ä¸è¶³</span>
<span class="bg-green-50 text-green-700 factor-tag">å¾®å¾ªç’°ä¸é€š</span>
<span class="bg-yellow-50 text-yellow-700 factor-tag">æ¯’ç´ </span>
<span class="bg-orange-50 text-orange-700 factor-tag">è¡€è„‚ç²˜ç¨ </span>
<span class="bg-purple-50 text-purple-700 factor-tag">å¯’æ¶¼æ¿•ç—‡</span>
<span class="bg-pink-50 text-pink-700 factor-tag">å…ç–«</span>
<span class="bg-indigo-50 text-indigo-700 factor-tag">æƒ…ç·’</span>
</div>
</div>
<div class="bg-neutral rounded-2xl p-2 mb-3 shadow-elevation-1">
<div class="flex flex-wrap gap-1.5 mb-2">
<button id="filter-all" class="bg-primary text-white px-2.5 py-1 rounded-lg text-xs font-medium hover:bg-[#007A69] transition btn-hover shadow-elevation-1">
<i class="fa fa-th-list mr-1"></i>é¡¯ç¤ºå…¨éƒ¨
</button>
<button data-factor="æ°”è¡€" class="bg-blue-600 text-white px-2.5 py-1 rounded-lg text-xs font-medium hover:bg-blue-700 transition btn-hover shadow-elevation-1">
<i class="fa fa-tag mr-1"></i>æ°£è¡€ä¸è¶³
</button>
<button data-factor="å¾®å¾ªç¯" class="bg-green-600 text-white px-2.5 py-1 rounded-lg text-xs font-medium hover:bg-green-700 transition btn-hover shadow-elevation-1">
<i class="fa fa-tag mr-1"></i>å¾®å¾ªç’°ä¸é€š
</button>
<button data-factor="æ¯’ç´ " class="bg-yellow-600 text-white px-2.5 py-1 rounded-lg text-xs font-medium hover:bg-yellow-700 transition btn-hover shadow-elevation-1">
<i class="fa fa-tag mr-1"></i>æ¯’ç´ 
</button>
<button data-factor="è¡€è„‚" class="bg-orange-600 text-white px-2.5 py-1 rounded-lg text-xs font-medium hover:bg-orange-700 transition btn-hover shadow-elevation-1">
<i class="fa fa-tag mr-1"></i>è¡€è„‚ç²˜ç¨ 
</button>
<button data-factor="å¯’å‡‰æ¹¿" class="bg-purple-600 text-white px-2.5 py-1 rounded-lg text-xs font-medium hover:bg-purple-700 transition btn-hover shadow-elevation-1">
<i class="fa fa-tag mr-1"></i>å¯’æ¶¼æ¿•ç—‡
</button>
<button data-factor="å…ç–«" class="bg-pink-600 text-white px-2.5 py-1 rounded-lg text-xs font-medium hover:bg-pink-700 transition btn-hover shadow-elevation-1">
<i class="fa fa-tag mr-1"></i>å…ç–«
</button>
<button data-factor="æƒ…ç»ª" class="bg-indigo-600 text-white px-2.5 py-1 rounded-lg text-xs font-medium hover:bg-indigo-700 transition btn-hover shadow-elevation-1">
<i class="fa fa-tag mr-1"></i>æƒ…ç·’
</button>
</div>
<div class="flex flex-wrap items-center justify-between gap-2">
<button id="filter-selected" class="bg-gray-700 text-white px-2.5 py-1 rounded-lg text-xs font-medium hover:bg-gray-800 transition btn-hover shadow-elevation-1">
<i class="fa fa-filter mr-1"></i>åªçœ‹å·²é¸
</button>
<div class="text-textPrimary text-sm font-medium">
å·²å‹¾é¸: <span id="selected-count" class="font-bold text-primary text-base">0</span>/100 å€‹ç—‡ç‹€
</div>
</div>
</div>
<div id="symptoms-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2 mb-4"></div>
<div class="text-center mt-4 mb-2">
<button id="back-to-info" class="bg-gray-200 hover:bg-gray-300 text-textPrimary font-bold py-1.5 px-4 rounded-xl shadow-elevation-1 transition btn-hover mr-2">
<i class="fa fa-arrow-left mr-1.5"></i>è¿”å›ä¿®æ”¹è³‡è¨Š
</button>
<button id="submit-checklist" class="bg-gradient-to-r from-primary to-[#006658] hover:from-[#007A69] hover:to-[#00594D] text-white font-bold py-2 px-5 rounded-xl shadow-elevation-2 transition btn-hover transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-primary/50">
<i class="fa fa-paper-plane mr-1.5"></i>æäº¤è‡ªæª¢è¡¨
</button>
<p class="text-xs text-textSecondary/70 mt-2">æäº¤å¾Œå°‡ç”Ÿæˆå°ˆæ¥­åƒè€ƒå ±å‘Šï¼Œè«‹ç¢ºä¿ä¿¡æ¯çœŸå¯¦æœ‰æ•ˆ</p>
</div>
</div>
</div>
</div>
<div id="success-modal" class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 hidden fade-in p-2">
<div class="bg-cardBg rounded-2xl p-4 max-w-md w-full mx-2 text-center shadow-elevation-3 transform transition-all hover:shadow-elevation-hover">
<div class="inline-flex items-center justify-center w-14 h-14 bg-green-100 rounded-full mb-3">
<i class="fa fa-check text-2xl text-primary"></i>
</div>
<h3 class="text-lg font-bold text-textPrimary mb-2">æäº¤æˆåŠŸï¼</h3>
<p class="text-textSecondary text-sm mb-3">å·²ç‚ºæ‚¨æ•´ç†å¥åº·å ±å‘Šï¼Œå¯ç›´æ¥åˆ†äº«çµ¦å¥½å‹</p>
<div id="report-summary" class="border border-gray-100 rounded-xl p-3 mb-3 bg-neutral/50 text-left result-summary">
<h4 class="text-sm font-medium text-textPrimary mb-2 flex items-center"><i class="fa fa-file-text-o text-primary mr-1.5"></i>å¥åº·å ±å‘Šæ‘˜è¦</h4>
<div id="summary-content" class="text-xs space-y-1.5"></div>
</div>
<div class="mb-3">
<button id="native-share-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-3 rounded-lg transition btn-hover shadow-elevation-1 flex items-center justify-center">
<i class="fa fa-share-alt mr-1"></i>åˆ†äº«å ±å‘Š
</button>
</div>
<script>
const LIFF_ID="2008578880-NznKeG2a";
const GAS_URL="https://script.google.com/macros/s/AKfycbykBtM2_PM7IZ-ZUU4tgTqVa1xGhVQFaZ523FXc4ivdLz_GZ09sdmL6s5zk7SdloFuG/exec";
const JSONP_TIMEOUT=15000;
const PERMANENT_EXPIRY_DATE="9999/12/31";
const factorStyles={æ°”è¡€:{className:'bg-blue-50 text-blue-700',label:'æ°£è¡€ä¸è¶³'},å¾®å¾ªç¯:{className:'bg-green-50 text-green-700',label:'å¾®å¾ªç’°ä¸é€š'},æ¯’ç´ :{className:'bg-yellow-50 text-yellow-700',label:'æ¯’ç´ '},è¡€è„‚:{className:'bg-orange-50 text-orange-700',label:'è¡€è„‚ç²˜ç¨ '},å¯’å‡‰æ¹¿:{className:'bg-purple-50 text-purple-700',label:'å¯’æ¶¼æ¿•ç—‡'},å…ç–«:{className:'bg-pink-50 text-pink-700',label:'å…ç–«'},æƒ…ç»ª:{className:'bg-indigo-50 text-indigo-700',label:'æƒ…ç·’'}};
const durationOptions=[{value:'',label:'è«‹é¸æ“‡æ™‚é–“'},{value:'1w',label:'1å‘¨å…§'},{value:'1-3m',label:'1-3å€‹æœˆ'},{value:'3-6m',label:'3-6å€‹æœˆ'},{value:'6m-1y',label:'6å€‹æœˆ-1å¹´'},{value:'1-2y',label:'1-2å¹´'},{value:'2-5y',label:'2-5å¹´'},{value:'5y+',label:'5å¹´ä»¥ä¸Š'}];
const severityOptions=[{value:'',label:'è«‹é¸æ“‡è¼•é‡'},{value:'mild',label:'è¼•å¾®ï¼ˆä¸å½±éŸ¿æ—¥å¸¸ç”Ÿæ´»ï¼‰'},{value:'moderate',label:'ä¸­ç­‰ï¼ˆå¶çˆ¾å½±éŸ¿ç”Ÿæ´»ï¼‰'},{value:'severe',label:'åš´é‡ï¼ˆæ˜é¡¯å½±éŸ¿ç”Ÿæ´»ï¼‰'}];
const fullSymptomData=[
{seq:1,symptom:"è¨˜æ†¶åŠ›ä¸‹é™",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:2,symptom:"æ€ç¶­æ–·é›»",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:3,symptom:"åæ‡‰é²éˆ",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:4,symptom:"å—œç¡",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:5,symptom:"å¤šå¤¢",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:"â—‹"},
{seq:6,symptom:"é ­æšˆ",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:"â—‹"},
{seq:7,symptom:"é ­ç–¼",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"â—‹",å…ç–«:"",æƒ…ç»ª:"â—‹"},
{seq:8,symptom:"é ­éº»",æ°”è¡€:"",å¾®å¾ªç¯:"â—‹",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:9,symptom:"æšˆè»Š",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:10,symptom:"å¤±çœ ",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:"â—‹"},
{seq:11,symptom:"é ­é¢æ²¹è†©",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"â—‹",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:12,symptom:"è„«é«®",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:13,symptom:"é ­é«®ç¨€å°‘",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:"â—‹"},
{seq:14,symptom:"æ˜“æ‰“å“ˆæ¬ ",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"â—‹",å…ç–«:"",æƒ…ç»ª:""},
{seq:15,symptom:"å¸¸å˜†æ°£",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:"â—‹"},
{seq:16,symptom:"çœ¼ä¹¾æ¾€",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:17,symptom:"çœ¼ç™¢",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"â—‹",æƒ…ç»ª:""},
{seq:18,symptom:"çœ¼ç—›",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"â—‹",æƒ…ç»ª:""},
{seq:19,symptom:"è¦–åŠ›æ¨¡ç³Š",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:20,symptom:"çœ¼å±å¤š",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:21,symptom:"çœ¼æ€•å…‰æµæ·š",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:22,symptom:"éº¥ç²’è…«",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:23,symptom:"è½åŠ›ä¸‹é™",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:"â—‹"},
{seq:24,symptom:"è€³ç™¢",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"â—‹",æƒ…ç»ª:""},
{seq:25,symptom:"è€³é³´",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:"â—‹"},
{seq:26,symptom:"è€³ç—›",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:27,symptom:"è€³å±å¤š",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:28,symptom:"è€³å…§æ½®æ¿•",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"â—‹",å…ç–«:"",æƒ…ç»ª:""},
{seq:29,symptom:"æ‰“é¼¾",æ°”è¡€:"",å¾®å¾ªç¯:"â—‹",æ¯’ç´ :"",è¡€è„‚:"â—‹",å…ç–«:"",æƒ…ç»ª:""},
{seq:30,symptom:"é¼»å¡",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"â—‹",å…ç–«:"â—‹",æƒ…ç»ª:""},
{seq:31,symptom:"æ„›æ‰“å™´åš",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"â—‹",å…ç–«:"â—‹",æƒ…ç»ª:""},
{seq:32,symptom:"å¸¸æµé»ƒæ¶•",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"â—‹",å…ç–«:"â—‹",æƒ…ç»ª:""},
{seq:33,symptom:"é¼»ç‚",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"â—‹",å…ç–«:"â—‹",æƒ…ç»ª:""},
{seq:34,symptom:"æ„Ÿå†’æ™‚é–“é•·",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"â—‹",å…ç–«:"â—‹",æƒ…ç»ª:""},
{seq:35,symptom:"å—“å­å¹²",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:36,symptom:"å–‰åš¨ç™¢",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"â—‹",æƒ…ç»ª:""},
{seq:37,symptom:"å–‰åš¨ç—›",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"â—‹",æƒ…ç»ª:"â—‹"},
{seq:38,symptom:"å’³å—½",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"â—‹",å…ç–«:"â—‹",æƒ…ç»ª:""},
{seq:39,symptom:"ç—°å¤š",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"â—‹",å…ç–«:"â—‹",æƒ…ç»ª:""},
{seq:40,symptom:"å‘¼å¸å›°é›£",æ°”è¡€:"",å¾®å¾ªç¯:"â—‹",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"â—‹",å…ç–«:"â—‹",æƒ…ç»ª:""},
{seq:41,symptom:"å£è‹¦",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:42,symptom:"å£å¹²",æ°”è¡€:"",å¾®å¾ªç¯:"â—‹",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:43,symptom:"å£è‡­",æ°”è¡€:"",å¾®å¾ªç¯:"â—‹",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:44,symptom:"å£è…”æ½°ç˜",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"â—‹",æƒ…ç»ª:""},
{seq:45,symptom:"èˆŒæ½°ç˜",æ°”è¡€:"",å¾®å¾ªç¯:"â—‹",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:"â—‹"},
{seq:46,symptom:"å˜´å”‡éº»",æ°”è¡€:"",å¾®å¾ªç¯:"â—‹",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:47,symptom:"èˆŒç¡¬",æ°”è¡€:"",å¾®å¾ªç¯:"â—‹",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:48,symptom:"èƒ¸æ‚¶æ°£çŸ­",æ°”è¡€:"",å¾®å¾ªç¯:"â—‹",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:49,symptom:"å¿ƒæ…Œå¿ƒæ‚¸",æ°”è¡€:"",å¾®å¾ªç¯:"â—‹",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:50,symptom:"å¿ƒçµç—›",æ°”è¡€:"",å¾®å¾ªç¯:"â—‹",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:51,symptom:"æŒ‡ç”²å‡¹é™·",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:52,symptom:"åŠæœˆç—•å°‘",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:53,symptom:"æ‰‹è…³è„«çš®",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:54,symptom:"æ‰‹è…³å‡ºæ±—",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"â—‹",å…ç–«:"",æƒ…ç»ª:""},
{seq:55,symptom:"æ‰‹è…³æ¶¼",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"â—‹",å…ç–«:"",æƒ…ç»ª:""},
{seq:56,symptom:"æ‰‹è…³ç†±",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:57,symptom:"æ‰‹è¶³éº»æœ¨",æ°”è¡€:"",å¾®å¾ªç¯:"â—‹",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:58,symptom:"å››è‚¢ä¹åŠ›",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:59,symptom:"éœè„ˆæ›²å¼µ",æ°”è¡€:"",å¾®å¾ªç¯:"â—‹",æ¯’ç´ :"",è¡€è„‚:"â—‹",å…ç–«:"",æƒ…ç»ª:""},
{seq:60,symptom:"é—œç¯€ç—›",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"â—‹",å…ç–«:"",æƒ…ç»ª:""},
{seq:61,symptom:"è‚©é…¸ç—›",æ°”è¡€:"",å¾®å¾ªç¯:"â—‹",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"â—‹",å…ç–«:"",æƒ…ç»ª:""},
{seq:62,symptom:"é ¸æ¤ç—›",æ°”è¡€:"",å¾®å¾ªç¯:"â—‹",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"â—‹",å…ç–«:"",æƒ…ç»ª:""},
{seq:63,symptom:"è…°é…¸ç—›",æ°”è¡€:"",å¾®å¾ªç¯:"â—‹",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"â—‹",å…ç–«:"",æƒ…ç»ª:""},
{seq:64,symptom:"å°¿æ¸¾æ¿",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:65,symptom:"å°¿å¤šæ²«",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:66,symptom:"å°¿æœ‰æ€ªå‘³",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:67,symptom:"å¤œå°¿å¤š",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"â—‹",å…ç–«:"",æƒ…ç»ª:""},
{seq:68,symptom:"ä¾¿ç§˜",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:"â—‹"},
{seq:69,symptom:"å¤§ä¾¿ä¸æˆå½¢",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"â—‹",å…ç–«:"",æƒ…ç»ª:"â—‹"},
{seq:70,symptom:"ä¾¿æºä¸æ·¨",æ°”è¡€:"",å¾®å¾ªç¯:"â—‹",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:71,symptom:"é«˜è¡€è„‚",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"â—‹",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:72,symptom:"é«˜è¡€å£“",æ°”è¡€:"",å¾®å¾ªç¯:"â—‹",æ¯’ç´ :"",è¡€è„‚:"â—‹",å…ç–«:"",æƒ…ç»ª:""},
{seq:73,symptom:"é«˜è¡€ç³–",æ°”è¡€:"",å¾®å¾ªç¯:"â—‹",æ¯’ç´ :"",è¡€è„‚:"â—‹",å…ç–«:"",æƒ…ç»ª:""},
{seq:74,symptom:"ä½è¡€ç³–",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:75,symptom:"ä½è¡€å£“",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:76,symptom:"ç¶“æœŸé ­ç—›",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:77,symptom:"æœˆç¶“é‡å°‘",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:78,symptom:"ç¶“æœŸæ™‚é•·",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:79,symptom:"ç¶“æœŸæ¨å",æ°”è¡€:"",å¾®å¾ªç¯:"â—‹",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"â—‹",å…ç–«:"",æƒ…ç»ª:""},
{seq:80,symptom:"æœˆç¶“æœ‰è¡€å¡Š",æ°”è¡€:"",å¾®å¾ªç¯:"â—‹",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"â—‹",å…ç–«:"",æƒ…ç»ª:""},
{seq:81,symptom:"ä¹³è…ºå¢ç”Ÿ",æ°”è¡€:"",å¾®å¾ªç¯:"â—‹",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"â—‹",å…ç–«:"",æƒ…ç»ª:""},
{seq:82,symptom:"ç¶“æœŸè…°ç—›",æ°”è¡€:"",å¾®å¾ªç¯:"â—‹",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"â—‹",å…ç–«:"",æƒ…ç»ª:""},
{seq:83,symptom:"ç¶“æœŸæå‰",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:"â—‹"},
{seq:84,symptom:"æœˆç¶“é‡å¤š",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:"â—‹"},
{seq:85,symptom:"ä¸æ„›èªªè©±",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:86,symptom:"æƒ¡å¿ƒ",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:87,symptom:"èƒƒè„¹",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:88,symptom:"èƒƒé…¸",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:89,symptom:"èƒƒç—›",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"â—‹",å…ç–«:"",æƒ…ç»ª:""},
{seq:90,symptom:"æ¶ˆåŒ–ä¸è‰¯",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:91,symptom:"è‚¥èƒ–",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"â—‹",å¯’å‡‰æ¹¿:"â—‹",å…ç–«:"",æƒ…ç»ª:""},
{seq:92,symptom:"çš®è†šç™¢",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:93,symptom:"æ¿•ç–¹",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"â—‹",å…ç–«:"â—‹",æƒ…ç»ª:""},
{seq:94,symptom:"å„ç¨®éæ•",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"â—‹",æƒ…ç»ª:""},
{seq:95,symptom:"ç—¤ç˜¡",æ°”è¡€:"",å¾®å¾ªç¯:"â—‹",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:96,symptom:"è„‚è‚ªç˜¤",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"â—‹",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:97,symptom:"èº«é«”ç•°å‘³",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""},
{seq:98,symptom:"æ·‹å·´çµå¤§",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"â—‹",æƒ…ç»ª:""},
{seq:99,symptom:"é»‘ç—£è®Šå¤§è®Šå¤š",æ°”è¡€:"",å¾®å¾ªç¯:"",æ¯’ç´ :"â—‹",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"â—‹",æƒ…ç»ª:""},
{seq:100,symptom:"å½¢é«”æ¶ˆç˜¦",æ°”è¡€:"â—‹",å¾®å¾ªç¯:"",æ¯’ç´ :"",è¡€è„‚:"",å¯’å‡‰æ¹¿:"",å…ç–«:"",æƒ…ç»ª:""}];

const setStatus=text=>{const e=document.getElementById('status-text');e&&(e.textContent=text);};
const showError=msg=>{
document.getElementById('status').classList.add('hidden');
document.getElementById('result-card').classList.add('hidden');
document.getElementById('user-info-section').classList.add('hidden');
document.getElementById('checklist-section').classList.add('hidden');
const e=document.getElementById('error-message'),c=document.getElementById('error-content');
e&&c&&(c.innerHTML=`<p class="font-medium">${msg}</p><div class="mt-3 flex justify-center"><button onclick="window.location.reload()" class="text-primary hover:text-[#007A69] font-medium flex items-center gap-1"><i class="fa fa-refresh"></i> é‡æ–°å˜—è©¦</button></div>`,e.classList.remove('hidden'));
};
const calculateRemainingDaysByDate=expiryDateStr=>{
try{
if(expiryDateStr===PERMANENT_EXPIRY_DATE)return{displayDate:"æ°¸ä¹…æœ‰æ•ˆ",remainingDays:"æ°¸ä¹…æœ‰æ•ˆ"};
const r=/^\d{4}[-\/]\d{2}[-\/]\d{2}$/;
if(!r.test(expiryDateStr))return{displayDate:"æ ¼å¼éŒ¯èª¤",remainingDays:"æ ¼å¼éŒ¯èª¤"};
const d=expiryDateStr.replace(/-/g,'/').split('/').map(Number),ed=new Date(Date.UTC(d[0],d[1]-1,d[2])),td=new Date(),tutc=new Date(Date.UTC(td.getFullYear(),td.getMonth(),td.getDate()));
if(isNaN(ed.getTime()))return{displayDate:"æ—¥æœŸç„¡æ•ˆ",remainingDays:"æ—¥æœŸç„¡æ•ˆ"};
const tdiff=ed-tutc,rd=Math.ceil(tdiff/(1000*3600*24)),fd=`${d[0]}/${String(d[1]).padStart(2,'0')}/${String(d[2]).padStart(2,'0')}`;
let rt;
if(rd<0)rt="<span class='text-red-500 font-medium'>å·²éæœŸ</span>";
else if(rd===0)rt="<span class='text-orange-500 font-medium'>æœ€å¾Œ1å¤©</span>";
else if(rd<=30)rt=`<span class='text-orange-500 font-medium'>${rd} å¤©</span>`;
else rt=`${rd} å¤©`;
return{displayDate:fd,remainingDays:rt};
}catch(e){console.error("è¨ˆç®—å‰©é¤˜å¤©æ•¸å¤±æ•—ï¼š",e,expiryDateStr);return{displayDate:"è¨ˆç®—éŒ¯èª¤",remainingDays:"è¨ˆç®—éŒ¯èª¤"}};
};

function renderSymptomCards(){
try{
const c=document.getElementById('symptoms-container');
if(!c)return false;
c.innerHTML='';
fullSymptomData.forEach((s,i)=>{
const rf=[],doh=durationOptions.map(o=>`<option value="${o.value}">${o.label}</option>`).join(''),soh=severityOptions.map(o=>`<option value="${o.value}">${o.label}</option>`).join('');
Object.entries(factorStyles).forEach(([k,st])=>s[k]==="â—‹"&&rf.push(`<span class="factor-tag ${st.className}">${st.label}</span>`));
const cd=document.createElement('div');
cd.className='symptom-card bg-cardBg border border-gray-100 rounded-xl p-2 shadow-elevation-1 card-hover';
cd.dataset.seq=s.seq;
cd.dataset.factors=Object.entries(factorStyles).filter(([k])=>s[k]==="â—‹").map(([k])=>k).join(',');
cd.style.opacity='0';
cd.style.transform='translateY(20px)';
cd.style.transition='all 0.3s cubic-bezier(0.34,1.56,0.64,1)';
cd.style.transitionDelay=`${i*15}ms`;
cd.innerHTML=`
<div class="flex items-start gap-2">
<div class="flex-shrink-0 mt-1"><input type="checkbox" id="symptom-${s.seq}" class="symptom-checkbox h-4 w-4 text-primary rounded border-gray-300 input-focus" data-seq="${s.seq}"></div>
<div class="flex-1">
<div class="flex justify-between items-start mb-1"><label for="symptom-${s.seq}" class="text-textPrimary font-medium cursor-pointer text-sm"><span class="text-primary mr-1 font-semibold">[${s.seq}]</span>${s.symptom}</label></div>
<div class="flex flex-wrap gap-1 mb-1">${rf.length>0?rf.join(''):'<span class="factor-tag bg-gray-50 text-gray-500">ç„¡ç›¸é—œè¦ç´ </span>'}</div>
<div class="symptom-details hidden mt-2 pt-2 border-t border-gray-100">
<div class="grid grid-cols-2 gap-2">
<div><label class="block text-xs text-textSecondary mb-1">æ™‚é–“é•·çŸ­</label><select class="duration-select w-full border border-gray-200 rounded-lg px-2 py-1 text-xs input-focus bg-white">${doh}</select></div>
<div><label class="block text-xs text-textSecondary mb-1">ç—‡ç‹€è¼•é‡</label><select class="severity-select w-full border border-gray-200 rounded-lg px-2 py-1 text-xs input-focus bg-white">${soh}</select><div class="severity-note">å‚™æ³¨ï¼šè¼•å¾®(ä¸å½±éŸ¿ç”Ÿæ´»)ã€ä¸­ç­‰(å¶çˆ¾å½±éŸ¿)ã€åš´é‡(æ˜é¡¯å½±éŸ¿)</div></div>
</div></div></div></div>`;
c.appendChild(cd);
setTimeout(()=>{cd.style.opacity='1';cd.style.transform='translateY(0)';},50);
});
bindCheckboxEvents();
return true;
}catch(e){console.error("æ¸²æŸ“ç—‡ç‹€å¡ç‰‡å‡ºéŒ¯ï¼š",e);return false;}
}

function bindCheckboxEvents(){
document.querySelectorAll('.symptom-checkbox').forEach(cb=>{
cb.addEventListener('change',function(){
const cd=this.closest('.symptom-card'),dt=cd.querySelector('.symptom-details');
this.checked?(dt.classList.remove('hidden'),cd.classList.add('border-primary/30','bg-secondary/20','shadow-elevation-2')):(dt.classList.add('hidden'),cd.classList.remove('border-primary/30','bg-secondary/20','shadow-elevation-2'),cd.querySelector('.duration-select').value='',cd.querySelector('.severity-select').value='');
updateSelectedCount();
});
});
}

function updateSelectedCount(){
const cnt=document.querySelectorAll('.symptom-checkbox:checked').length;
document.getElementById('selected-count').textContent=cnt;
return cnt;
}

function initFilterButtons(){
const fb=document.querySelectorAll('[data-factor], #filter-all');
let cf='all',sos=false;
fb.forEach(b=>{
b.addEventListener('click',function(){
fb.forEach(bt=>bt.classList.remove('shadow-elevation-2','scale-105'));
this.classList.add('shadow-elevation-2','scale-105');
cf=this.id==='filter-all'?'all':this.dataset.factor;
applyFilters();
});
});
document.getElementById('filter-selected').addEventListener('click',function(){
sos=!sos;
if(sos){this.classList.remove('bg-gray-700','hover:bg-gray-800');this.classList.add('bg-red-600','hover:bg-red-700','shadow-elevation-2');this.innerHTML='<i class="fa fa-filter mr-1"></i>é¡¯ç¤ºå…¨éƒ¨å·²å‹¾é¸';}
else{this.classList.remove('bg-red-600','hover:bg-red-700','shadow-elevation-2');this.classList.add('bg-gray-700','hover:bg-gray-800');this.innerHTML='<i class="fa fa-filter mr-1"></i>åªçœ‹å·²é¸';}
applyFilters();
});
function applyFilters(){
document.querySelectorAll('.symptom-card').forEach(cd=>{
let ss=true;
if(cf!=='all'){const cfs=cd.dataset.factors.split(',');ss=cfs.includes(cf);}
if(sos&&ss)ss=cd.querySelector('.symptom-checkbox').checked;
if(ss){cd.style.display='block';setTimeout(()=>{cd.style.opacity='1';cd.style.transform='translateY(0)';},10);}
else{cd.style.opacity='0';cd.style.transform='translateY(10px)';setTimeout(()=>{cd.style.display='none';},300);}
});
}
}

function organizeReportData(submitData){
const {userBasicInfo,selectedSymptoms,displayName,submitTime}=submitData,fs={æ°”è¡€:[],å¾®å¾ªç¯:[],æ¯’ç´ :[],è¡€è„‚:[],å¯’å‡‰æ¹¿:[],å…ç–«:[],æƒ…ç»ª:[]};
selectedSymptoms.forEach(s=>{
const os=fullSymptomData.find(ss=>ss.seq===s.seq);
os&&Object.keys(fs).forEach(f=>os[f]==="â—‹"&&fs[f].push({name:s.symptom,duration:s.durationText,severity:s.severityText}));
});
const ffs=Object.fromEntries(Object.entries(fs).filter(([_,f])=>f.length>0)),fui={
å§“å:userBasicInfo.name||'æœªå¡«å¯«',
å¹´é½¡:userBasicInfo.age?`${userBasicInfo.age}æ­²`:'æœªå¡«å¯«',
æ€§åˆ¥:userBasicInfo.gender==='male'?'ç”·':userBasicInfo.gender==='female'?'å¥³':'æœªå¡«å¯«',
èº«é«˜:userBasicInfo.height?`${userBasicInfo.height}cm`:'æœªå¡«å¯«',
é«”é‡:userBasicInfo.weight?`${userBasicInfo.weight}kg`:'æœªå¡«å¯«',
è¡€å£“:userBasicInfo.bp||'æœªå¡«å¯«',
è¡€ç³–:userBasicInfo.glucose?`${userBasicInfo.glucose}%`:'æœªå¡«å¯«',
è·æ¥­:userBasicInfo.job||'æœªå¡«å¯«',
æäº¤æ™‚é–“:new Date(submitTime).toLocaleString('zh-TW',{year:'numeric',month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit'})
};
let st=`ğŸ§¬ å½¥å½¬å¥åº·è‡ªæª¢å ±å‘Š\n\nğŸ‘¤ ç”¨æˆ¶ï¼š${displayName}\nğŸ“… æäº¤æ™‚é–“ï¼š${fui.æäº¤æ™‚é–“}\n\nğŸ“‹ åŸºæœ¬è³‡æ–™ï¼š\n`;
Object.entries(fui).forEach(([k,v])=>k!=='æäº¤æ™‚é–“'&&(st+=`  ${k}ï¼š${v}\n`));
const ts=Object.values(ffs).reduce((s,f)=>s+f.length,0);
st+=`\nğŸ“Š çµ±è¨ˆè³‡è¨Šï¼š\n  ç¸½é¸å–ç—‡ç‹€æ•¸ï¼š${ts} é …\n\nğŸ©º ä¸ƒå¤§å¥åº·è¦ç´ è©•ä¼°ï¼š\n`;
Object.entries(ffs).forEach(([fk,f])=>{
const fn=factorStyles[fk].label;
st+=`\nã€${fn}ã€‘(${f.length}é …)ï¼š\n`;
f.forEach((i,idx)=>st+=`  ${idx+1}. ${i.name}\n     â±ï¸ æ™‚é–“ï¼š${i.duration}\n     âš ï¸ ç¨‹åº¦ï¼š${i.severity}\n`);
});
st+=`\nğŸ’¡ å»ºè­°ï¼šæ ¹æ“šè‡ªæª¢çµæœé—œæ³¨å°æ‡‰å¥åº·å•é¡Œï¼Œå¿…è¦æ™‚è«®è©¢å°ˆæ¥­é†«å¸«`;
return {formattedUserInfo:fui,factorSymptoms:ffs,summaryText:st};
}

function initControlButtons(){
// ä¸‹ä¸€æ­¥æŒ‰éˆ•
document.getElementById('next-to-checklist').addEventListener('click',function(){
const n=document.getElementById('user-name').value.trim(),a=document.getElementById('user-age').value.trim(),g=document.getElementById('user-gender').value;
if(!n){alert('è«‹è¼¸å…¥å§“å');document.getElementById('user-name').focus();return;}
if(!a||isNaN(a)||a<0||a>120){alert('è«‹è¼¸å…¥æœ‰æ•ˆå¹´é½¡');document.getElementById('user-age').focus();return;}
if(!g){alert('è«‹é¸æ“‡æ€§åˆ¥');document.getElementById('user-gender').focus();return;}
window.userBasicInfo={
name:n,age:parseInt(a),gender:g,
height:document.getElementById('user-height').value?parseInt(document.getElementById('user-height').value):null,
weight:document.getElementById('user-weight').value?parseFloat(document.getElementById('user-weight').value):null,
bp:document.getElementById('user-bp').value.trim()||null,
glucose:document.getElementById('user-glucose').value?parseFloat(document.getElementById('user-glucose').value):null,
job:document.getElementById('user-job').value.trim()||null
};
document.getElementById('user-info-section').classList.add('hidden');
document.getElementById('checklist-section').classList.remove('hidden');
renderSymptomCards();
initFilterButtons();
document.getElementById('checklist-section').scrollIntoView({behavior:'smooth'});
});

// è¿”å›æŒ‰éˆ•
document.getElementById('back-to-info').addEventListener('click',function(){
document.getElementById('checklist-section').classList.add('hidden');
document.getElementById('user-info-section').classList.remove('hidden');
if(window.userBasicInfo){
document.getElementById('user-name').value=window.userBasicInfo.name||'';
document.getElementById('user-age').value=window.userBasicInfo.age||'';
document.getElementById('user-gender').value=window.userBasicInfo.gender||'';
document.getElementById('user-height').value=window.userBasicInfo.height||'';
document.getElementById('user-weight').value=window.userBasicInfo.weight||'';
document.getElementById('user-bp').value=window.userBasicInfo.bp||'';
document.getElementById('user-glucose').value=window.userBasicInfo.glucose||'';
document.getElementById('user-job').value=window.userBasicInfo.job||'';
}
document.getElementById('user-info-section').scrollIntoView({behavior:'smooth'});
});

// æäº¤æŒ‰éˆ•
document.getElementById('submit-checklist').addEventListener('click',function(){
const sc=updateSelectedCount();
if(sc===0){alert('è«‹è‡³å°‘å‹¾é¸ä¸€å€‹ç—‡ç‹€');return;}
let iv=true,fic=null;
document.querySelectorAll('.symptom-checkbox:checked').forEach(cb=>{
const cd=cb.closest('.symptom-card'),d=cd.querySelector('.duration-select').value,s=cd.querySelector('.severity-select').value;
if(!d||!s){iv=false;fic=fic||cd;cd.classList.add('border-red-500');cd.style.transform='scale(1.03)';setTimeout(()=>{cd.classList.remove('border-red-500');cd.style.transform='';},1500);}
});
if(!iv){alert('éƒ¨åˆ†å·²é¸ç—‡ç‹€æœªå¡«å¯«å®Œæ•´è³‡è¨Šï¼Œè«‹æª¢æŸ¥å¾Œå†æäº¤');fic&&fic.scrollIntoView({behavior:'smooth',block:'center'});return;}
const sd=collectSubmitData();
submitChecklistData(sd);
});

// æ ¸å¿ƒä¿®å¾©ï¼šåˆ†äº«æŒ‰éˆ•ï¼ˆè§£æ±ºé»æ“Šç„¡å›æ‡‰ï¼‰
const shareBtn=document.getElementById('native-share-btn');
if(shareBtn){
shareBtn.addEventListener('click',async function(e){
e.stopPropagation();// é˜»æ­¢äº‹ä»¶å†’æ³¡
try{
// 1. å…ˆæª¢æŸ¥å¿…è¦ä¾è³´å’Œå…ƒç´ 
if(!window.html2canvas){alert('åˆ†äº«åŠŸèƒ½ä¾è³´ç¼ºå¤±ï¼Œè«‹åˆ·æ–°é é¢é‡è©¦');return;}
const scEl=document.getElementById('summary-content'),mc=document.querySelector('#success-modal .modal-content');
if(!scEl||!mc){alert('å ±å‘Šå…§å®¹æœªæ‰¾åˆ°');return;}
const st=scEl.dataset.summary;
if(!st){alert('å ±å‘Šæ•¸æ“šç•°å¸¸');return;}

// 2. ç§»é™¤èˆŠæŒ‰éˆ•+é¡¯ç¤ºåŠ è¼‰ç‹€æ…‹
const escb=mc.querySelector('.share-close-btn');
escb&&escb.remove();
shareBtn.disabled=true;
shareBtn.innerHTML='<i class="fa fa-spinner fa-spin mr-1"></i> è™•ç†ä¸­...';

// 3. ç°¡åŒ–æˆªåœ–é‚è¼¯ï¼ˆç›´æ¥æˆªåŸå®¹å™¨ï¼Œé¿å…è‡¨æ™‚DOMå•é¡Œï¼‰
scEl.style.backgroundColor='#ffffff';
scEl.style.padding='16px';
const canvas=await html2canvas(scEl,{
scale:1.2,// é™ä½åˆ†è¾¨ç‡æ¸›å°‘å¡é “
useCORS:true,
allowTaint:true,
logging:false,
backgroundColor:'#ffffff',
width:scEl.offsetWidth,
height:scEl.offsetHeight
});

// 4. è½‰æ›åœ–ç‰‡ï¼ˆç°¡åŒ–Blobè™•ç†ï¼‰
const dataUrl=canvas.toDataURL('image/png',0.6);
const imgBlob=await (await fetch(dataUrl)).blob();
const fileName=`å½¥å½¬å¥åº·è‡ªæª¢å ±å‘Š_${new Date().toLocaleDateString()}.png`;
const file=new File([imgBlob],fileName,{type:'image/png'});

// 5. åˆ†äº«é‚è¼¯ï¼ˆå¢å¼·å…¼å®¹æ€§æª¢æ¸¬ï¼‰
if(navigator.share&&typeof navigator.share==='function'){
try{
const shareData={title:'ğŸ§¬ å½¥å½¬å¥åº·è‡ªæª¢å ±å‘Š',text:st,files:[file]};
// å…¼å®¹ä¸åŒç€è¦½å™¨çš„canShareå¯¦ç¾
const canShare=navigator.canShare?await navigator.canShare(shareData):true;
if(canShare){
await navigator.share(shareData);
alert('åˆ†äº«æˆåŠŸï¼');
}else{
// ä¸æ”¯æŒæ–‡ä»¶åˆ†äº«å‰‡åˆ†äº«æ–‡å­—
await navigator.share({title:shareData.title,text:shareData.text});
alert('æ–‡å­—åˆ†äº«æˆåŠŸï¼Œå ±å‘Šåœ–ç‰‡å·²ä¸‹è¼‰');
downloadImage(dataUrl,fileName);
}
}catch(err){
console.error('åˆ†äº«å¤±æ•—ï¼š',err);
// ç”¨æˆ¶å–æ¶ˆä¸æç¤º
if(err.name!=='AbortError'){
downloadImage(dataUrl,fileName);
alert(`åˆ†äº«å¤±æ•—ï¼š${err.message||'æœªçŸ¥éŒ¯èª¤'}ï¼Œå·²è‡ªå‹•ä¸‹è¼‰å ±å‘Š`);
}
}
}else{
// ä¸æ”¯æŒåŸç”Ÿåˆ†äº«ï¼šä¸‹è¼‰+è¤‡è£½æ–‡å­—
downloadImage(dataUrl,fileName);
try{
await navigator.clipboard.writeText(st);
alert('ç€è¦½å™¨ä¸æ”¯æŒåˆ†äº«ï¼Œå·²ä¸‹è¼‰å ±å‘Šä¸¦è¤‡è£½æ–‡å­—å…§å®¹');
}catch(cbErr){
alert('ç€è¦½å™¨ä¸æ”¯æŒåˆ†äº«ï¼Œå·²ä¸‹è¼‰å ±å‘Šï¼Œè«‹æ‰‹å‹•è¤‡è£½æ–‡å­—å…§å®¹');
}
}
}catch(err){
console.error('åˆ†äº«ç¸½é«”éŒ¯èª¤ï¼š',err);
// æœ€çµ‚é™çº§ï¼šç¢ºä¿ç”¨æˆ¶èƒ½ç²å–æ•¸æ“š
downloadImage(dataUrl||canvas.toDataURL('image/png',0.6),fileName||`å¥åº·å ±å‘Š_${new Date().getTime()}.png`);
alert('åˆ†äº«åŠŸèƒ½ç•°å¸¸ï¼Œå·²è‡ªå‹•ä¸‹è¼‰å ±å‘Šåœ–ç‰‡');
}finally{
// æ¢å¾©æŒ‰éˆ•ç‹€æ…‹
shareBtn.disabled=false;
shareBtn.innerHTML='<i class="fa fa-share-alt mr-1"></i> åˆ†äº«å ±å‘Š';
// æ·»åŠ é—œé–‰æŒ‰éˆ•
addShareCloseButton(mc);
}
});
}

// ä¸‹è¼‰åœ–ç‰‡å·¥å…·å‡½æ•¸
function downloadImage(dataUrl,fileName){
const link=document.createElement('a');
link.href=dataUrl;
link.download=fileName;
link.style.display='none';
document.body.appendChild(link);
link.click();
setTimeout(()=>document.body.removeChild(link),300);
}

// æ·»åŠ é—œé–‰æŒ‰éˆ•
function addShareCloseButton(modalContent){
const btn=document.createElement('button');
btn.className='share-close-btn mt-3 w-full py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition-colors';
btn.innerHTML='<i class="fa fa-times mr-1"></i> é—œé–‰';
btn.addEventListener('click',function(){
document.getElementById('success-modal').classList.add('hidden');
resetChecklist();
document.getElementById('user-info-section').scrollIntoView({behavior:'smooth'});
});
modalContent.appendChild(btn);
}
}

function collectSubmitData(){
const liffProfile=liff.getProfile()||{};
const selectedSymptoms=Array.from(document.querySelectorAll('.symptom-checkbox:checked')).map(cb=>{
const seq=cb.dataset.seq,cd=cb.closest('.symptom-card');
return{
seq:parseInt(seq),
symptom:cd.querySelector('label').textContent.replace(/^\[\d+\]/,'').trim(),
durationText:cd.querySelector('.duration-select option:checked').textContent,
severityText:cd.querySelector('.severity-select option:checked').textContent
};
});
return{
action:'submitChecklist',
userId:liff.getDecodedIDToken()?.sub||'',
displayName:liffProfile.displayName||'LINEç”¨æˆ¶',
submitTime:new Date().toISOString(),
userName:document.getElementById('user-name').value.trim(),
userAge:document.getElementById('user-age').value.trim(),
userGender:document.getElementById('user-gender').value,
userHeight:document.getElementById('user-height').value.trim()||'',
userWeight:document.getElementById('user-weight').value.trim()||'',
userBp:document.getElementById('user-bp').value.trim()||'',
userGlucose:document.getElementById('user-glucose').value.trim()||'',
userJob:document.getElementById('user-job').value.trim()||'',
selectedSymptoms:JSON.stringify(selectedSymptoms)
};
}

function submitChecklistData(data){
console.log("æäº¤æ•¸æ“šï¼š",data);
setStatus('æäº¤ä¸­...');
document.getElementById('status').classList.remove('hidden');
$.ajax({
url:GAS_URL,
dataType:'jsonp',
jsonp:'callback',
jsonpCallback:'submitCallback',
timeout:JSONP_TIMEOUT,
data:data,
success:function(resp){
document.getElementById('status').classList.add('hidden');
const rd=organizeReportData({...data,userBasicInfo:window.userBasicInfo,selectedSymptoms:JSON.parse(data.selectedSymptoms)});
renderReportSummary(rd);
const mc=document.querySelector('#success-modal .modal-content');
if(mc&&!mc.querySelector('.close-modal-btn')){
const cb=document.createElement('button');
cb.className='close-modal-btn mt-4 w-full py-2 bg-primary text-white rounded-lg font-medium hover:bg-primary/90 transition-colors';
cb.innerHTML='<i class="fa fa-times mr-1"></i> é—œé–‰å ±å‘Š';
cb.addEventListener('click',function(){
document.getElementById('success-modal').classList.add('hidden');
resetChecklist();
document.getElementById('user-info-section').scrollIntoView({behavior:'smooth'});
});
mc.appendChild(cb);
}
document.getElementById('success-modal').classList.remove('hidden');
setTimeout(()=>{
mc&&(mc.style.maxHeight='80vh');
document.getElementById('report-summary')&&(document.getElementById('report-summary').style.maxHeight='60vh');
},100);
},
error:function(xhr,status,err){
console.error("æäº¤å¤±æ•—ï¼š",status,err);
document.getElementById('status').classList.add('hidden');
showError('æäº¤å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ï¼ˆ'+status+'ï¼‰');
}
});
}

function renderReportSummary(reportData){
const {formattedUserInfo,factorSymptoms,summaryText}=reportData;
const sc=document.getElementById('summary-content'),rs=document.getElementById('report-summary');
sc.dataset.summary=summaryText;
const ts=Object.values(factorSymptoms).reduce((s,f)=>s+f.length,0);

// åŸºç¤æ¨£å¼ç¢ºä¿æˆªåœ–æ­£å¸¸
rs.style.maxHeight='60vh';
rs.style.overflowY='auto';
rs.style.padding='16px';
rs.style.boxSizing='border-box';
sc.style.width='100%';
sc.style.backgroundColor='#ffffff';
sc.style.padding='16px';

// æ§‹å»ºHTML
let html=`<div class="font-medium text-primary mb-1.5">ğŸ‘¤ åŸºæœ¬è³‡æ–™</div><div class="info-grid">`;
const infoEntries=Object.entries(formattedUserInfo),stEntry=infoEntries.find(([k])=>k==='æäº¤æ™‚é–“');
infoEntries.forEach(([k,v])=>{
if(k!=='æäº¤æ™‚é–“'){
const label=k==='è¡€ç³–'?'è¡€ç³–ï¼ˆç³–åŒ–è¡€è‰²ç´ ï¼‰':k;
html+=`<div class="info-item"><span class="text-textSecondary">${label}ï¼š</span><span class="font-medium">${v}</span></div>`;
}
});
html+=`</div>`;
html+=`<div class="mt-1.5 text-sm"><span class="text-textSecondary">æäº¤æ™‚é–“ï¼š</span><span class="font-medium">${stEntry[1]}</span></div>`;
html+=`<div class="mt-2 text-sm"><span class="text-textSecondary">ç¸½é¸å–ç—‡ç‹€æ•¸ï¼š</span><span class="font-medium text-primary">${ts} é …</span></div>`;
html+=`<div class="font-medium text-primary mt-3 mb-1.5">ğŸ©º ä¸ƒå¤§å¥åº·è¦ç´ è©•ä¼°</div>`;
Object.entries(factorSymptoms).forEach(([fk,f])=>{
const fn=factorStyles[fk].label;
html+=`<div class="mt-2"><div class="font-medium">ã€${fn}ã€‘ï¼ˆ${f.length}é …ï¼‰</div><div class="ml-2 mt-1 space-y-1">`;
f.forEach((i,idx)=>html+=`<div class="text-xs">${idx+1}. ${i.name} <span class="text-textSecondary">(${i.duration} Â· ${i.severity})</span></div>`);
html+=`</div></div>`;
});
sc.innerHTML=html;

// èª¿æ•´é«˜åº¦ç¢ºä¿å®Œæ•´é¡¯ç¤º
setTimeout(()=>{rs.style.height=sc.offsetHeight+30+'px';},150);
}

function resetChecklist(){
document.querySelectorAll('.symptom-checkbox').forEach(cb=>{cb.checked&&(cb.checked=false,cb.dispatchEvent(new Event('change')));});
document.getElementById('filter-all').click();
const fsBtn=document.getElementById('filter-selected');
fsBtn.classList.contains('bg-red-600')&&fsBtn.click();
window.userBasicInfo=null;
document.getElementById('user-name').value='';
document.getElementById('user-age').value='';
document.getElementById('user-gender').value='';
document.getElementById('user-height').value='';
document.getElementById('user-weight').value='';
document.getElementById('user-bp').value='';
document.getElementById('user-glucose').value='';
document.getElementById('user-job').value='';
}

function forceShowUserInfo(){
try{
const uis=document.getElementById('user-info-section');
if(!uis){alert("é é¢åŠ è¼‰å¤±æ•—ï¼Œè«‹åˆ·æ–°");return false;}
uis.classList.remove('hidden');
initControlButtons();
return true;
}catch(e){console.error("é¡¯ç¤ºç”¨æˆ¶è³‡è¨Šå‡ºéŒ¯ï¼š",e);alert("é é¢åŠ è¼‰å¤±æ•—ï¼Œè«‹åˆ·æ–°");return false;}
}

// é é¢åŠ è¼‰åˆå§‹åŒ–ï¼ˆç¢ºä¿æ‰€æœ‰DOMåŠ è¼‰å®Œæˆå¾Œå†ç¶å®šäº‹ä»¶ï¼‰
document.addEventListener('DOMContentLoaded',function(){
console.log("é é¢åŠ è¼‰å®Œæˆï¼Œåˆå§‹åŒ–ç³»çµ±");
setStatus('æ­£åœ¨åˆå§‹åŒ–...');
// ç¢ºä¿LIFFåŠ è¼‰å®Œæˆ
if(!window.liff){
showError('LINE LIFFåˆå§‹åŒ–å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²çµ¡æˆ–é‡æ–°æ‰“é–‹é é¢');
return;
}
liff.init({liffId:LIFF_ID},{disableRedirect:true})
.then(()=>{
console.log("LIFFåˆå§‹åŒ–æˆåŠŸ");
liff.isLoggedIn()?getProfileAndVerify():liff.login();
})
.catch(err=>{
console.error("LIFFåˆå§‹åŒ–å¤±æ•—ï¼š",err);
if(err.message.includes('expired')||err.message.includes('token')||err.message.includes('auth')){
setStatus('ä»¤ç‰Œç„¡æ•ˆï¼Œé‡æ–°ç™»éŒ„...');
setTimeout(()=>liff.login(),1000);
}else{
showError('ç³»çµ±åˆå§‹åŒ–å¤±æ•—ï¼š'+err.message);
}
});
});

function getProfileAndVerify(){
setStatus('é©—è­‰ç”¨æˆ¶è³‡è¨Š...');
liff.getProfile()
.then(profile=>{
console.log("ç²å–LINEè³‡æ–™æˆåŠŸï¼š",profile);
callGasBackend(profile.userId,profile.displayName||'LINEç”¨æˆ¶');
})
.catch(err=>{
console.error("ç²å–LINEè³‡æ–™å¤±æ•—ï¼š",err);
const tokenErrs=['expired','token','auth','invalid','session'];
const isTokenErr=tokenErrs.some(k=>err.message.toLowerCase().includes(k));
if(isTokenErr){
setStatus('ä»¤ç‰ŒéæœŸï¼Œé‡æ–°ç™»éŒ„...');
liff.isLoggedIn()?liff.logout().then(()=>setTimeout(()=>liff.login(),1000)).catch(()=>liff.login()):setTimeout(()=>liff.login(),1000);
}else{
showError('å–å¾—ç”¨æˆ¶è³‡æ–™å¤±æ•—ï¼š'+err.message);
}
});
}

function callGasBackend(userId,displayName){
$.ajax({
url:GAS_URL,
dataType:'jsonp',
jsonp:'callback',
jsonpCallback:'verifyCallback',
timeout:JSONP_TIMEOUT,
data:{userId:userId,displayName:displayName,action:'verifyUser',needExpiryDate:true},
success:function(resp){
console.log("å¾Œç«¯è¿”å›ï¼š",resp);
resp.status==="error"?showError(resp.message):renderResult(resp);
},
error:function(xhr,status,err){
console.error("AJAXéŒ¯èª¤ï¼š",status,err);
const errMsg=status==='timeout'?'è«‹æ±‚è¶…æ™‚ï¼Œæª¢æŸ¥ç¶²çµ¡':status==='parsererror'?'æ•¸æ“šè§£æéŒ¯èª¤':'èˆ‡ä¼ºæœå™¨é€šè¨Šå¤±æ•—';
showError(errMsg);
}
});
}

function renderResult(resp){
document.getElementById('status').classList.add('hidden');
document.getElementById('error-message').classList.add('hidden');
const card=document.getElementById('result-card'),main=document.getElementById('result-main'),details=document.getElementById('result-details');
const isPro=resp.isAdmin===true,un=resp.displayName||'ç”¨æˆ¶',ed=resp.expiryDate||resp.endDate||resp.expireDate||'';
if(isPro){
const{displayDate,remainingDays}=calculateRemainingDaysByDate(ed);
main.innerHTML=`<span class="text-primary"><i class="fa fa-check-circle mr-1.5"></i>å°ˆæ¥­ç”¨æˆ¶é©—è­‰é€šé</span>`;
details.innerHTML=`
<div><i class="fa fa-user-circle text-primary mr-1"></i>ç”¨æˆ¶åç¨±ï¼š<span class="font-medium">${un}</span></div>
<div><i class="fa fa-calendar-check-o text-primary mr-1"></i>ä½¿ç”¨æœŸé™ï¼š<span class="font-medium">${displayDate}</span></div>
<div><i class="fa fa-clock-o text-primary mr-1"></i>å‰©é¤˜å¤©æ•¸ï¼š${remainingDays}</div>
`;
}else{
const uc=resp.usageCount||0,rt=Math.max(0,3-uc);
if(rt<=0){
main.innerHTML=`<span class="text-orange-600"><i class="fa fa-exclamation-circle mr-1.5"></i>æ™®é€šç”¨æˆ¶ä½¿ç”¨æ¬¡æ•¸å·²ç”¨å®Œ</span>`;
details.innerHTML=`
<div><i class="fa fa-user-circle text-orange-600 mr-1"></i>ç”¨æˆ¶åç¨±ï¼š<span class="font-medium">${un}</span></div>
<div><i class="fa fa-calendar-o text-orange-600 mr-1"></i>ä½¿ç”¨æœŸé™ï¼š<span class="font-medium">-</span></div>
<div><i class="fa fa-refresh text-orange-600 mr-1"></i>å‰©é¤˜æ¬¡æ•¸ï¼š<span class="text-red-500 font-medium">${rt} æ¬¡</span></div>
<div><i class="fa fa-info-circle text-orange-600 mr-1"></i>æç¤ºï¼šè«‹è¯ç¹«ç®¡ç†å“¡å‡ç´š</div>
`;
card.classList.remove('hidden');
return;
}else{
main.innerHTML=`<span class="text-textPrimary"><i class="fa fa-user mr-1.5"></i>æ™®é€šç”¨æˆ¶é©—è­‰é€šé</span>`;
details.innerHTML=`
<div><i class="fa fa-user-circle text-textPrimary mr-1"></i>ç”¨æˆ¶åç¨±ï¼š<span class="font-medium">${un}</span></div>
<div><i class="fa fa-calendar-o text-textPrimary mr-1"></i>ä½¿ç”¨æœŸé™ï¼š<span class="font-medium">-</span></div>
<div><i class="fa fa-refresh text-textPrimary mr-1"></i>å‰©é¤˜æ¬¡æ•¸ï¼š<span class="font-medium text-primary">${rt} æ¬¡</span></div>
`;
}
}
card.classList.remove('hidden');
setTimeout(()=>forceShowUserInfo(),300);
}

// å…¨å±€å›èª¿å‡½æ•¸
window.submitCallback=resp=>{console.log("submitCallback:",resp);return resp;};
window.verifyCallback=resp=>{console.log("verifyCallback:",resp);return resp;};
</script>
</body>
</html>
